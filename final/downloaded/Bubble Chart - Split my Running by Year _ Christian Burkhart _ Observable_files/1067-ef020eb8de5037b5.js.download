"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1067],{37809:function(e,t,s){s.d(t,{b:function(){return c}});var n=s(41799),i=s(69396),l=s(99534),a=s(85893),r=s(49516),o=s(87671);s(67294);const c=e=>{var{type:t="error",spacing:s="pv3 ph3",className:c="",title:d="",description:u="",children:m}=e,h=(0,l.Z)(e,["type","spacing","className","title","description","children"]);return(0,a.jsxs)("div",(0,i.Z)((0,n.Z)({className:"".concat(s," ").concat(c," br2"),style:{background:"".concat("warning"!==t?"success"===t?" #eef5f2":" #fdf1f1":" #fdf9ed")}},h),{children:["error"===t&&(0,a.jsxs)("div",{className:"flex f6 fw6 dark-red br2 items-center lh-title",children:[(0,a.jsx)(o.Z,{className:"w1 h1 mr2 white bg-red b--dark-red flex-no-shrink br-pill"}),d]}),"warning"===t&&(0,a.jsxs)("div",{className:"flex f6 fw6 gold items-center lh-title",children:[(0,a.jsx)(o.Z,{className:"w1 h1 mr2 white bg-yellow b--gold flex-no-shrink br-pill"}),d]}),"success"===t&&(0,a.jsxs)("div",{className:"flex f6 fw6 dark-green items-center lh-title",children:[(0,a.jsx)(r.Z,{className:"flex w1 h1 mr2 white bg-green b--dark-green flex-no-shrink br-pill"}),d]}),u&&(0,a.jsx)("div",{className:"pl2 mt1 ml3 f7 fw5 dark-gray lh-f7",children:u}),m]}))}},58171:function(e,t,s){s.d(t,{P:function(){return u},g:function(){return d}});var n=s(41799),i=s(69396),l=s(99534),a=s(85893),r=s(65988),o=s.n(r);s(67294);const c=new String("select.jsx-8a6f66adb6c4dd0d{outline:0px;padding-right:24px;background-position:right 8px center;background-repeat:no-repeat}select.jsx-8a6f66adb6c4dd0d::-ms-expand{display:none}");c.__hash="8a6f66adb6c4dd0d";const d=e=>{var{className:t="",children:s,disabled:r}=e,d=(0,l.Z)(e,["className","children","disabled"]);return(0,a.jsxs)("select",(0,i.Z)((0,n.Z)({disabled:r},d),{className:"jsx-d0719c1526f662d3 "+"jsx-".concat(c.__hash)+" "+"br2 form-default-clear bn animate-all fw6 ph2 pv1 f7 lh-f7\n      ".concat(r?" bg-near-white mid-gray":" dark-gray pointer","\n      ").concat(t),children:[s,(0,a.jsx)(o(),{id:c.__hash,children:c}),(0,a.jsx)(o(),{id:"d0719c1526f662d3",children:"select.jsx-d0719c1526f662d3{-webkit-box-shadow:var(--silver)0px 0px 0px 1px,inset -1px -1px var(--silver);-moz-box-shadow:var(--silver)0px 0px 0px 1px,inset -1px -1px var(--silver);box-shadow:var(--silver)0px 0px 0px 1px,inset -1px -1px var(--silver);background-image:url(\"data:image/svg+xml,%3Csvg width='8' height='16' viewBox='0 0 8 16' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 7L4 9.5L7 7' stroke='rgb(196, 196, 196)' fill='none' stroke-width='1.8' stroke-linecap='square'/%3E%3C/svg%3E%0A\")}"})]}))},u=e=>{var{children:t,disabled:s=!1,bordered:r=!0,className:d=""}=e,u=(0,l.Z)(e,["children","disabled","bordered","className"]);const m=s?"moon-gray":"blue",h=s?"":"pointer animate-all hover-bg-black-05",b=r?s?"b--silver":"b--light-gray":"b--transparent";return(0,a.jsxs)("select",(0,i.Z)((0,n.Z)({disabled:s},u),{className:"jsx-baf07ef590aebba2 "+"jsx-".concat(c.__hash)+" "+"".concat(m," ").concat(b," ").concat(h," ").concat(d," f6 fw6 br2 ba pa2 bg-transparent form-default-clear"),children:[t,(0,a.jsx)(o(),{id:c.__hash,children:c}),(0,a.jsx)(o(),{id:"baf07ef590aebba2",children:"select.jsx-baf07ef590aebba2{background-image:url(\"data:image/svg+xml, %3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8' viewBox='0 0 8 8' fill='none'%3E%3Cpath d='M5.91938 2H2.08062C1.24212 2 0.775946 2.96993 1.29976 3.6247L3.21913 6.02391C3.61946 6.52432 4.38054 6.52432 4.78087 6.02391L6.70024 3.62469C7.22405 2.96993 6.75788 2 5.91938 2Z' fill='%233b5fc0' /%3E%3C/svg%3E\")}select[disabled].jsx-baf07ef590aebba2{background-image:url(\"data:image/svg+xml, %3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8' viewBox='0 0 8 8' fill='none'%3E%3Cpath d='M5.91938 2H2.08062C1.24212 2 0.775946 2.96993 1.29976 3.6247L3.21913 6.02391C3.61946 6.52432 4.38054 6.52432 4.78087 6.02391L6.70024 3.62469C7.22405 2.96993 6.75788 2 5.91938 2Z' fill='%23c4c4c4' /%3E%3C/svg%3E\")}"})]}))}},776:function(e,t,s){s.d(t,{i:function(){return r}});var n=s(41799),i=s(69396),l=s(99534),a=s(85893);s(67294);const r=e=>{var{className:t=""}=e,s=(0,l.Z)(e,["className"]);return(0,a.jsx)("input",(0,i.Z)((0,n.Z)({},s),{type:"range",style:{height:6},className:"form-default-clear form-custom-slider br-pill ".concat(s.disabled?" mid-gray bg-black-10 disabled ":" dark-gray bg-light-silver hover-near-black"," ").concat(s.disabled?" disabled not-allowed":" animate-all pointer"," ").concat(t,"\n     ")}))}},24576:function(e,t,s){s.d(t,{g:function(){return o}});var n=s(41799),i=s(69396),l=s(99534),a=s(85893);function r(e){let{currentTarget:t}=e;t.style.height="initial",t.style.height="".concat(t.scrollHeight,"px")}const o=s(67294).forwardRef((function(e,t){const{hasError:s=!1,autoResize:o=!1,className:c="",style:d,rows:u}=e,m=(0,l.Z)(e,["hasError","autoResize","className","style","rows"]);return(0,a.jsx)("textarea",(0,i.Z)((0,n.Z)({},m),{ref:e=>{"function"===typeof t?t(e):t&&(t.current=e),e&&r({currentTarget:e})},onInput:o?r:void 0,rows:o?1:u,style:(0,n.Z)({resize:"vertical"},d,o&&{resize:"none",maxHeight:void 0===u?"none":"calc(".concat(u," * 1.5em + 2 * var(--spacing-small))")}),className:"form-default-clear form-custom-input pa2 f6 fw5 br2 lh-copy ".concat(e.disabled?" mid-gray bg-near-white disabled":" dark-gray bg-white blue-ring-focus"," ").concat(c," ").concat(s?" has-error":"")}))}))},20042:function(e,t,s){s.d(t,{o:function(){return x}});var n=s(41799),i=s(69396),l=s(99534),a=s(85893),r=s(55267),o=s(602),c=s(44754),d=s(67294),u=s(8385),m=s(15612),h=s(89905);function b(e){return{login:e,invited:!0}}const g=e=>{let{member:t,flagExternal:s,expandVertically:n}=e;return"invited"in t?(0,a.jsxs)("div",{className:"flex truncate items-center",children:[(0,a.jsx)("div",{className:"mr2 br-100 bg-light-silver flex items-center justify-center",style:{height:24,width:24},children:(0,a.jsx)(r.Z,{height:14,className:"mid-gray"})}),(0,a.jsxs)("div",{className:"truncate",children:[t.login," ",(0,a.jsx)("span",{className:"truncate gray",children:"(Invite)"})]})]}):(0,a.jsxs)("div",{className:"flex truncate items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex truncate items-center",children:[(0,a.jsx)(u.q,{user:t,size:24,className:"mr2 br-100"}),(0,a.jsx)("div",{className:"truncate",children:t.name?(0,a.jsx)(a.Fragment,{children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"truncate",children:t.name}),t.name!==t.login&&(0,a.jsxs)("div",{className:"truncate gray",children:["@",t.login]})]}):(0,a.jsxs)(a.Fragment,{children:[t.name,"\xa0",t.name!==t.login&&(0,a.jsxs)("span",{className:"truncate gray",children:["(@",t.login,")"]})]})}):t.login})]}),s&&!t.is_teammate&&(0,a.jsx)("div",{className:"gray f7 ml2",children:"External"})]})},x=e=>{var{universe:t,initialSuggestions:s,excluded:r,onSelectUser:u,disabled:x,placeholder:p,value:f,allowEmail:v=!1,emailLimit:j=1,teamId:w,type:y,expandVertically:k,id:N}=e,C=(0,l.Z)(e,["universe","initialSuggestions","excluded","onSelectUser","disabled","placeholder","value","allowEmail","emailLimit","teamId","type","expandVertically","id"]);const[Z,S,_]=(0,c.G)("");(0,d.useEffect)((()=>{S("")}),[f,S]);const[L,R]=(0,o.h_)((()=>{const e=_.trim();return!t&&e.length>=2&&e.length<=40?"/users-match?".concat(new URLSearchParams((0,n.Z)({input:e},y?{type:y}:{},w?{teamId:w}:{}))):null})),{0:M,1:U}=(0,d.useState)(void 0),{0:E,1:D}=(0,d.useState)(!1),{0:T,1:A}=(0,d.useState)(!1),{0:V,1:I}=(0,d.useState)(!1);(0,d.useEffect)((()=>{if(!Z.length)return U(s||void 0),void D(!1);const e=[];if(v){const t=_.split(/[,\s]/).map((e=>e.trim().toLowerCase())).filter(Boolean);let s=!1;t.forEach((e=>{(function(e){return null!==/^\S+@\S+\.\S+$/.exec(e)})(e)||(s=!0,function(e){return null!==/^\S+@/.exec(e)}(e)||t.length>1?A(!0):A(!1))})),!s&&t.length<=j?(t.length>1?e.push(b(_.trim())):1===t.length&&e.push(b(t[0])),D(!1),A(!1),I(!1)):t.length>j&&I(!0)}if(t){const s=Z.toLocaleLowerCase(),l="@"===Z.at(0)&&Z.length>1;e.push(...t.map((e=>(0,i.Z)((0,n.Z)({},e),{is_teammate:!0}))).filter((e=>!(null===r||void 0===r?void 0:r.some((t=>t.id===e.id)))&&(e.name&&e.name.toLowerCase().indexOf(s)>-1||"".concat(l?"@":"").concat(e.login).toLowerCase().indexOf(s)>-1))).sort(((e,t)=>(e.name||e.login).localeCompare(t.name||t.login)))),U(e)}else L&&!R?(e.push(...L.filter((e=>!(null===r||void 0===r?void 0:r.some((t=>t.id===e.id)))))),U(e)):U(e)}),[L,u,t,r,Z,_,v,j,R,s]);const{0:F,1:q}=(0,d.useState)(!1);return(0,d.useEffect)((()=>{if(F&&M&&L&&M.length>0){const e=M.find((e=>e.login===Z));e?(u(e),D(!1)):v?D(!0):S(""),q(!1)}else F&&M&&L&&0===L.length&&(q(!1),v?D(!0):S(""))}),[M,F,Z,u,S,L,v]),(0,a.jsxs)(m.hQ,(0,i.Z)((0,n.Z)({openOnFocus:void 0!==M,onSelect:e=>{M&&(u(M[+e]),D(!1))}},C),{children:[f?(0,a.jsxs)("div",{className:"h2 ph2 pv1 br2 form-custom-input flex items-center justify-between w-100",children:[(0,a.jsx)(g,{member:f,flagExternal:!!w,expandVertically:!1}),(0,a.jsx)(h.Z,{className:"gray pointer",onClick:()=>u(null)}),(0,a.jsx)(m.gA,{className:"dn"})]}):(0,a.jsx)(m.gA,{id:N,className:"w-100 border-box form-default-clear","data-cy":"user-select",placeholder:p,disabled:x,autocomplete:!1,value:Z,onChange:e=>S(e.target.value),onKeyDown:e=>{"Enter"===e.key&&q(!0)},onBlur:()=>{S("")},style:E&&v?{borderColor:"var( --dark-pink )",borderStyle:"solid",borderWidth:"1px",boxShadow:"none"}:{}}),M&&(0,a.jsxs)(m.SF,{children:[M.length>0?(0,a.jsx)(m.Gk,{className:"overflow-auto",style:{maxHeight:"20rem"},children:M.map(((e,t)=>(0,a.jsx)(m.O2,{className:"pa2",value:String(t),onMouseDown:e=>e.preventDefault(),children:(0,a.jsx)(g,{member:e,flagExternal:!!w,expandVertically:null!==k&&void 0!==k&&k})},e.login)))}):(0,a.jsx)("p",{className:"ma2 pa1 f6 fw5 mid-gray",children:Z&&Z.length>=2?(0,a.jsx)(a.Fragment,{children:"team"===y?"No teams found":V?"You can only invite ".concat(j," users at a time"):T?"Incomplete email address":"No users found"}):(0,a.jsx)(a.Fragment,{children:"team"===y?"Type to search teams":"Type to search users"})}),s&&s.length>0&&s===M&&(0,a.jsx)("p",{className:"ma2 pa1 f6 fw5 mid-gray",children:"team"===y?"... or type to search teams":"... or type to search users"})]})]}))}},87671:function(e,t,s){var n=s(41799),i=s(69396),l=s(85893);s(67294);t.Z=e=>(0,l.jsx)("svg",(0,i.Z)((0,n.Z)({width:"8",height:"16",viewBox:"0 0 8 16",fill:"none"},e),{children:(0,l.jsx)("path",{d:"M2.8703 4L3.0578 9.68359H4.9328L5.1203 4H2.8703ZM3.9953 12.6602C4.75116 12.6602 5.19647 12.2676 5.19647 11.5938C5.19647 10.9141 4.75116 10.5215 3.9953 10.5215C3.23944 10.5215 2.79999 10.9141 2.79999 11.5938C2.79999 12.2676 3.23944 12.6602 3.9953 12.6602Z",fill:"currentColor"})}))},71043:function(e,t,s){s.d(t,{Z:function(){return o}});var n=s(41799),i=s(99534),l=s(85893),a=(s(67294),s(69396));var r=e=>(0,l.jsx)("svg",(0,a.Z)((0,n.Z)({width:"8",height:"16",viewBox:"0 0 8 16",fill:"none"},e),{children:(0,l.jsx)("path",{d:"M2.98713 12.6H5.00005V6H2.98713V12.6ZM4 5.16211C4.60352 5.16211 5.10156 4.6875 5.10156 4.08398C5.10156 3.48047 4.60352 3 4 3C3.39648 3 2.89844 3.48047 2.89844 4.08398C2.89844 4.6875 3.39648 5.16211 4 5.16211Z",fill:"currentColor"})}));var o=e=>{var{className:t}=e,s=(0,i.Z)(e,["className"]);return(0,l.jsx)(r,(0,n.Z)({className:"br-pill light-blue bg-observable-faint-blue ".concat(t),width:"18",height:"18"},s))}},55267:function(e,t,s){var n=s(41799),i=s(69396),l=s(85893);s(67294);t.Z=e=>(0,l.jsxs)("svg",(0,i.Z)((0,n.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,l.jsx)("rect",{x:"2",y:"3",width:"12",height:"10",rx:"0.5",stroke:"currentColor",strokeWidth:"1.5"}),(0,l.jsx)("path",{d:"M9.74104 7.4806L14.541 12.4806L13.459 13.5194L8.65896 8.5194L9.74104 7.4806ZM1.45896 12.4806L6.25896 7.4806L7.34104 8.5194L2.54104 13.5194L1.45896 12.4806Z",fill:"currentColor"}),(0,l.jsx)("path",{d:"M8 9L7.46967 9.53033C7.76256 9.82322 8.23744 9.82322 8.53033 9.53033L8 9ZM1.46967 3.53033L7.46967 9.53033L8.53033 8.46967L2.53033 2.46967L1.46967 3.53033ZM8.53033 9.53033L14.5303 3.53033L13.4697 2.46967L7.46967 8.46967L8.53033 9.53033Z",fill:"currentColor"})]}))},76305:function(e,t,s){var n=s(41799),i=s(69396),l=s(85893);s(67294);t.Z=e=>(0,l.jsxs)("svg",(0,i.Z)((0,n.Z)({width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round"},e),{children:[(0,l.jsx)("path",{d:"M3 10C2.46373 10 1 9.57867 1 8C1 6.42133 2 5.5 3.5 5.5C3.5 3 5.5 1 8 1C11 1 12.5 3.5 12.5 4C15.5 4 16.2061 10 13 10"}),(0,l.jsx)("path",{d:"M11 10L8 7L5 10"}),(0,l.jsx)("path",{d:"M7.99805 14.3882L7.99805 7.38818"})]}))},28925:function(e,t,s){s.d(t,{E:function(){return k}});var n=s(41799),i=s(69396),l=s(99534),a=s(85893),r=s(94184),o=s.n(r),c=s(37497),d=s(33090),u=s(776),m=s(76305),h=s(58127),b=s(2741),g=s(88725),x=s(67294),p=s(27011),f=s.n(p);const v=["image/gif","image/jpeg","image/jpg","image/png"];function j(e){return e.dataTransfer.items.length?!!w(e.dataTransfer.items):e.dataTransfer.types.includes("Files")}function w(e){for(const t of e)if(t.type&&t.type.startsWith("image/"))return t}const y=156.25,k=e=>{var{disabled:t,thumbnail:s,defaultThumbnail:r,onValueChange:p,className:k}=e,N=(0,l.Z)(e,["disabled","thumbnail","defaultThumbnail","onValueChange","className"]);const{isDraggingOver:C,dragAndDropEvents:Z}=(0,h.Y)((e=>{t||z(e.dataTransfer.files)}),j),{0:S,1:_}=(0,x.useState)(!1),{0:L,1:R}=(0,x.useState)(),{0:M,1:U}=(0,x.useState)();(0,x.useEffect)((()=>{s&&r!==s&&(R(s),_(!0),U(""))}),[s,r]);const{0:E,1:D}=(0,x.useState)(null),T=(0,x.useRef)(null),{0:A,1:V}=(0,x.useState)(1),{0:I,1:F}=(0,x.useState)(),q=(0,x.useRef)(null),P=(0,x.useRef)(null);function z(e){try{const t=w(e);if(t){const e=URL.createObjectURL(t);U(e),_(!0),V(1),D("")}else e.length&&D("Sorry, that image format is not supported.")}catch(t){console.error(t)}}(0,x.useEffect)((()=>{P.current&&P.current.focus()}),[]),(0,x.useEffect)((()=>{S||D(""),T.current&&T.current.setCustomValidity(!S||!E&&L?"":"Please upload an image"),p(S&&L?L:"")}),[p,S,L,E]);const O=(0,x.useRef)();function B(){if(D(""),q.current){O.current&&O.current();const e=setTimeout((()=>{if(O.current=void 0,q.current&&q.current.getCroppingRect()){const e=q.current.getImage(),t=document.createElement("canvas");t.width=640,t.height=400;const s=t.getContext("2d");s.fillStyle="#fff",s.fillRect(0,0,640,400),s.drawImage(e,0,0,e.width,e.height,0,0,640,400);const n=t.toDataURL("image/jpeg",.7);R(n)}}),150);O.current=()=>clearTimeout(e)}}return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:o()("flex items-top flex-wrap flex-nowrap-l",k),onClick:()=>{P.current&&P.current.focus()},children:[(0,a.jsxs)("div",{className:"mr2",children:[(0,a.jsx)(d.E,{disabled:t,name:"thumbnail",label:"Automatic",checked:!S,onChange:e=>_("on"!==e.target.value)}),(0,a.jsx)(d.E,{className:"f6 fw6 near-black mb3",disabled:t,name:"thumbnail",label:"Custom",description:"Use a .png or .jpg that is at least 640x400 pixels",checked:S,onChange:e=>_("on"===e.target.value)}),(0,a.jsx)("input",(0,n.Z)({disabled:t,hidden:!0,ref:T,onInvalid:e=>e.preventDefault(),onInput:()=>{},value:S&&L?L:""},N)),(0,a.jsx)("input",{className:"ma0 pa0 bw0 absolute",disabled:t,type:"text",style:{opacity:0,width:0,height:0},ref:P,onPaste:e=>z(e.clipboardData.files)}),(0,a.jsxs)("div",{className:"flex items-top mb2",children:[(0,a.jsx)("div",{className:"db-l dn ml2 mr3"}),(0,a.jsx)(c.aX,{disabled:t,text:"Upload file",icon:m.Z,onClick:()=>(0,b.Z)({accept:v.join()}).then((e=>{z(e)}))})]})]}),(0,a.jsxs)("div",{children:[!(S&&M)&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",(0,i.Z)((0,n.Z)({},Z),{className:o()("flex flex-column ba",E&&!C?"b--dark-pink":C?"b--dashed b-dark-gray":"b--moon-gray"),style:{width:250,height:y,backgroundImage:S&&L?"url(".concat((0,g.Nl)(L),")"):!S&&r?"url(".concat((0,g.Nl)(r),")"):"var(--checkerboard)",backgroundSize:S&&L||!S&&r?"cover":"8%"}}))}),S&&M&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",(0,i.Z)((0,n.Z)({},Z),{className:o()("flex flex-column ba",E?"b--dark-pink":C?"b--dashed b--dark-gray":"b--white"),children:(0,a.jsx)(f(),{image:M,ref:q,width:198,height:123.75,scale:A,position:I,borderRadius:0,onPositionChange:e=>F(e),onImageReady:B,onImageChange:B,onLoadFailure:function(){D("Unable to read that image."),U("")}})})),(0,a.jsxs)("div",{className:"flex items-center mid-gray mt2",children:[(0,a.jsx)("label",{className:"mr2 f6",htmlFor:"scale-range",children:"Zoom"}),(0,a.jsx)(u.i,{className:"flex-grow-1",name:"scale-range",onChange:e=>V(e.target.valueAsNumber),value:A,step:"any",min:1,max:2})]})]}),E?(0,a.jsx)("div",{className:"dark-pink f7 fw4 mb2 mt1",children:E}):null]})]})})}},98572:function(e,t,s){s.d(t,{$:function(){return it}});var n=s(41799),i=s(69396),l=s(5804),a=s(85893),r=s(56424),o=s(77063),c=s(43529),d=s(44516),u=s(47495),m=s(93452),h=s(6016),b=s(29162),g=s(65678),x=s(42510),p=s(10718),f=s(33042);const v=(0,s(4242).$j)(((e,t)=>{let{notebook:s}=e,{id:n}=t;return{data:(0,f.DY)(s.model,n).data}}),(e=>({dispatch:e})))((e=>{let{dispatch:t,onDismiss:s,id:n,data:i,operation:l}=e;const f=(0,p.v)(i,t),v={filter:o.Z,columns:c.Z,sort:u.Z,slice:d.Z};return(0,a.jsxs)(r.Vq,{onDismiss:s,children:[(0,a.jsx)(m.xB,{title:l.charAt(0).toUpperCase()+l.slice(1),icon:v[l],onDismiss:s}),(0,a.jsx)("div",{className:"pa3 bt b--silver",children:"filter"===l?(0,a.jsx)(b.c7,{id:n,data:i,dispatch:t,schema:f}):"columns"===l?(0,a.jsx)(h.J_,{data:i,dispatch:t,id:n,schema:f}):"sort"===l?(0,a.jsx)(x.dE,{id:n,data:i,dispatch:t,schema:f}):(0,a.jsx)(g.ck,{data:i,dispatch:t,id:n})})]})}));var j=s(99534),w=s(54329),y=s(602),k=s(19671),N=s(70915),C=s(66421),Z=s(3142),S=s(81816),_=s(36448),L=s(67294),R=s(36620),M=(s(14416),s(54924));const U=(0,M.S3)();(0,M.gR)();var E=s(8385),D=s(37497),T=s(16691),A=s(11233),V=s(58171),I=s(24576),F=s(22027);function q(e,t,s){const n={user:e,public:t.filter((e=>"public"===e.type&&e.id!==s)),private:t.filter((e=>"private"===e.type&&e.id!==s))},i=function(e){const t=new Set(e.map((e=>e.id)));return(e,s)=>+t.has(s.id)-+t.has(e.id)||e.title.localeCompare(s.title)}(t);return n.public.sort(i),n.private.sort(i),n}const P=e=>{let{collection:t,checked:s,onChange:n}=e;return(0,a.jsxs)("label",{htmlFor:"collection-".concat(t.id),className:"flex f6 fw5 dark-gray hover-blue flex-auto pointer",children:[(0,a.jsx)(T.X,{id:"collection-".concat(t.id),checked:s,onChange:e=>n(t,e.target.checked),spacing:""}),(0,a.jsx)("span",{title:t.title,className:"truncate pointer",children:t.title})]})};const z=e=>{let{group:t,type:s,selected:n,onChange:i,filters:l,restricted:r=!1}=e;const o="public"===s?t.public:t.private,c=o.filter((e=>function(e,t){return t.every((t=>e.toLowerCase().includes(t)))}(e.title,l)));return(0,a.jsxs)("div",{className:"mt1",children:[(0,a.jsxs)("div",{className:"f7 fw5 gray",children:[(0,a.jsx)("span",{className:"ttc",children:s})," collections (",l.length?"".concat(c.length," / "):"",o.length,")"]}),r?(0,a.jsx)("div",{className:"f7 gray lh-f7",children:"Only team owners can add public or shared notebooks to public collections."}):c.length>0&&(0,a.jsx)("div",{className:"pt1 pb3",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gridGap:"10px"},children:c.map((e=>(0,a.jsx)(P,{collection:e,checked:n.some((t=>t.id===e.id)),onChange:i},e.id)))})]},s)},O=e=>{let{onCollectionCreated:t,owner:s,currentUser:n}=e;const i="private",{0:l,1:r}=(0,L.useState)(i),{0:o,1:c}=(0,L.useState)("");return(0,a.jsxs)("form",{onSubmit:async function(e){e.preventDefault();const a=await(0,N.BL)(o,l,s);a&&(t(s,l,a),(0,k.MR)((0,k.y6)({type:"collection:manage:create",data:{trigger:"click",source:"notebookCollectionsModal"},eventVersion:1,collection:a,currentUser:n})),c(""),r(i))},className:"flex items-center",autoComplete:"off",children:[(0,a.jsx)(A.Z,{name:"title",placeholder:"New collection",type:"text",className:"overflow-hidden flex-grow-1",value:o,onChange:e=>c(e.target.value)}),(0,a.jsxs)(V.P,{name:"type",onChange:e=>r(e.target.value),value:l,disabled:!o,className:"mh2",children:[(0,a.jsx)("option",{value:"private",children:"team"===s.type?"Team Private":"Private"}),(0,C.XM)(n,s)&&(0,a.jsx)("option",{value:"public",children:"Public"})]}),(0,a.jsx)(D.aX,{text:"Create",type:"submit",disabled:!o})]})},B=e=>{const{collectionListing:t,onDismiss:s,dispatch:n}=e,i=e.currentUser,{owner:l}=t,o=Y(t)?t.collections:t.parent_collections,{0:c,1:d}=(0,L.useState)(o),{0:u,1:h}=(0,L.useState)(null),{0:b,1:g}=(0,L.useState)(!1),{0:x,1:p}=(0,L.useState)([]),{0:f,1:v}=(0,L.useState)(t.description),j=t.description!==f,k=c.filter((e=>!o.some((t=>t.id===e.id)))),N=o.filter((e=>!c.some((t=>t.id===e.id)))),S=0===k.length&&0===N.length&&!j,R=(0,C.Zs)(i,t),[M,,U]=(0,y.h_)(R?"/collections/@".concat(l.login):null),T=!Y(t)||(0,Z.s9)(t)||(0,Z.Gw)(t)?i.teams.find((e=>e.id!==l.id&&(0,C.pb)(e))):void 0,[V]=(0,y.h_)(T?"/collections/@".concat(T.login):null);function P(e,t){d(t?c.concat(e):c.filter((t=>t.id!==e.id)))}(0,L.useEffect)((()=>{d(o)}),[o]),(0,L.useEffect)((()=>{if((!R||M)&&(!T||V)){const e=[],s=H(t)?t.id:void 0;M&&e.push(q(l,M,s)),T&&V&&e.push(q(T,V,s)),h(e.filter((e=>e.public.length+e.private.length>0)).sort(function(e){return(t,s)=>{let{user:n}=t,{user:i}=s;return n.id===e.id?-1:i.id===e.id?1:n.login.localeCompare(i.login)}}(i)))}}),[M,V,T,R,i,l,t]);const B=c.length?c.map((e=>e.title)).join(", "):"None",X=f&&f.length||0;return(0,a.jsxs)(r.Vq,{onDismiss:s,"aria-labelledby":"modal-title",children:[(0,a.jsx)(m.xB,{title:"Add to collection",icon:w.Z,onDismiss:s}),(0,a.jsxs)(m.fe,{children:[(0,a.jsxs)("div",{className:"truncate f6 fw5 gray",children:[(0,a.jsxs)("span",{children:["Selected (",c.length,"): "]}),(0,a.jsx)("b",{title:B,className:"fw6 dark-gray",children:B})]}),(0,a.jsx)(A.Z,{name:"filter",className:"db w-100 mt2 mb3",placeholder:"Filter collections",type:"text",onChange:e=>p(e.target.value.toLowerCase().split(/\s+/).filter((e=>e)))}),(0,a.jsx)("div",{className:"mv2 overflow-auto",style:{height:250},children:null===u?(0,a.jsxs)("div",{className:"flex f7 fw6 gray items-center justify-center lh-copy fade-in delay-short h-100",children:[(0,a.jsx)(F.Z,{}),(0,a.jsx)("span",{className:"ml2",children:"Loading"})]}):u.length>0?u.map((e=>(0,a.jsxs)("div",{className:"pb1 mb3",children:[(u.length>1||e.user.id!==i.id)&&(0,a.jsxs)("div",{className:"flex mb2 f6 fw5 near-black items-center",children:[(0,a.jsx)(E.q,{user:e.user,size:16,className:"mr2 br-100"}),(0,a.jsx)("span",{children:(0,_.RX)(e.user)})]}),e.private.length?(0,a.jsx)(z,{type:"private",group:e,filters:x,selected:c,onChange:P},"".concat(e.user.id,":private")):null,e.public.length?(0,a.jsx)(z,{type:"public",group:e,filters:x,selected:c,onChange:P,restricted:Y(t)&&!(0,C.M6)(i,e.user,t)},"".concat(e.user.id,":public")):null]},e.user.id))):(0,a.jsx)("div",{className:"flex f7 fw5 gray items-center justify-center lh-copy fade-in h-100",children:"You don\u2019t have any collections."})})]}),(0,a.jsxs)(m.mz,{children:[(0,C.pq)(i,l)&&(0,a.jsx)(O,{owner:l,onCollectionCreated:function(e,t,s){s&&(P(s,!0),U())},currentUser:i}),Y(t)&&(0,C.qG)(i,t)&&(0,a.jsxs)("div",{className:"mv3",children:[(0,a.jsx)("div",{className:"mv2 fw5 dark-gray",children:"Set notebook description (internal use only)"}),(0,a.jsx)(I.g,{name:"description",className:"db w-100",placeholder:"Enter notebook description. Currently only used for editorial purposes, e.g. our blog.",value:f||"",maxLength:300,onChange:e=>v(e.target.value)}),(0,a.jsx)("div",{className:"flex flex-column items-end mt2 gray f7 fw5",children:(0,a.jsx)("div",{children:"(".concat(X,"/").concat(300,")")})})]}),(0,a.jsxs)(D.CQ,{className:"mt2",children:[(0,a.jsx)(D.kq,{text:"Cancel",onClick:s}),(0,a.jsx)(D.KM,{disabled:S,loading:b,onClick:function(){g(!0),H(t)?n({type:"updateCollectionInCollections",addTo:k,removeFrom:N,collectionId:t.id,onDismiss:s}):(n({type:"collections",addTo:k,removeFrom:N,onDismiss:s}),f&&j&&n({type:"descriptionUpdate",description:f,onDismiss:s}))},text:"Confirm"})]})]})]})},X=U((e=>{let{currentUser:t}=e;return{currentUser:t}}),(e=>({dispatch:e})))((e=>{const{collectionListing:t,onDismiss:s}=e,i=(0,j.Z)(e,["collectionListing","onDismiss"]),[l,,r]=(0,y.h_)(function(e){return"type"in e&&("notebook_reader"===e.type||"notebook_owner"===e.type)}(t)?"/document/".concat(t.id):null),[o,,c]=(0,y.h_)(function(e){return"listing_type"in e&&"collection"===e.listing_type}(t)||function(e){return"ordered"in e&&!("listing_type"in e)}(t)?"/collection/@".concat(t.owner.login,"/").concat(t.slug,"?").concat((0,S.P)({page:1})):null),{0:d,1:u}=(0,L.useState)();(0,L.useEffect)((()=>{Y(t)||H(t)?u(t):l?((0,C.iU)(e.currentUser,l),u((0,R.D)({initialNotebook:l,initialCurrentUser:e.currentUser,initialContext:l.owner}))):u(o||void 0)}),[t,u,l,o,e.currentUser]);const m=(0,L.useCallback)((()=>{r(),c(),s()}),[r,c,s]);return d?(0,a.jsx)(B,(0,n.Z)({collectionListing:d,onDismiss:m},i)):null}));function Y(e){return"collections"in e}function H(e){return"parent_collections"in e}var G=s(23952),K=s(76267);var W=s(37809),Q=s(33090),$=s(87769),J=s(92946),ee=s(27193),te=s(4598),se=s(47692),ne=s(44754),ie=s(88725),le=s(75107);const ae=/^[0-9a-z_-]+(?:\/[0-9]+)?$/;var re;function oe(e){return e===re.Conflict?"A notebook already exists at that URL.":e===re.Invalid?"URL can only include lowercase alphanumeric characters, hyphens, underscores, and an optional forward slash suffix (/2).":e===re.TooLong?"URL must be less than 255 characters long.":null}!function(e){e[e.Empty=0]="Empty",e[e.Conflict=1]="Conflict",e[e.Invalid=2]="Invalid",e[e.TooLong=3]="TooLong",e[e.Available=4]="Available"}(re||(re={}));const ce=new URL("https://observablehq.com"),de=e=>{var{slug:t,title:s,owner:i,notebookId:l,isPublic:r,onValueChange:o,className:c="",disabled:d}=e,u=(0,j.Z)(e,["slug","title","owner","notebookId","isPublic","onValueChange","className","disabled"]);const[m,h,b]=(0,ne.G)("",250),{0:g,1:x}=(0,L.useState)(re.Available),{0:p,1:f}=(0,L.useState)(!1),{0:v,1:w}=(0,L.useState)(""),{0:k,1:N}=(0,L.useState)(),[C]=(0,y.h_)((()=>d||!m||b!==m||g!==re.Available&&g!==re.Conflict?null:"/document/".concat(l,"/slug-exists?slug=").concat(encodeURIComponent(b.replace(/\/$/,"")))));(0,L.useEffect)((()=>{k&&clearTimeout(k)}),[]),(0,L.useEffect)((()=>{f(!!t)}),[r,t,h]),(0,L.useEffect)((()=>{p?(w("@".concat(i.login,"/")),h(t||(s?(0,le.O)(s):""))):(w(r?(0,ie.UW)({id:l,owner:i,slug:(0,le.O)(s)}).substring(1):"d/".concat(l)),h(""))}),[t,h,p,s,r]),(0,L.useEffect)((()=>{o(m)}),[o,m]),(0,L.useEffect)((()=>{let e=re.Available;m?m.length>255?e=re.TooLong:ae.exec(m)?(null===C||void 0===C?void 0:C.exists)&&(e=re.Conflict):e=re.Invalid:e=re.Empty,x(e),R(oe(e)),Z.current&&Z.current.setCustomValidity(p&&e!==re.Available?"Please enter a Url":""),o(m)}),[m,x,C,o,p]);const Z=(0,L.useRef)(null),S=g!==re.Available&&g!==re.Empty,{0:_,1:R}=(0,L.useState)(oe(g));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-column",children:[(0,a.jsx)(Q.E,{disabled:d,name:"slugMode",label:"Automatic",checked:!p,onChange:e=>f("on"!==e.target.value)}),(0,a.jsx)(Q.E,{disabled:d,name:"slugMode",label:"Custom",checked:p,onChange:e=>f("on"===e.target.value)})]}),(0,a.jsxs)("div",{className:"flex lh-default",children:[(0,a.jsxs)("div",{className:"ba br2 pa0 flex items-stretch f6 fw4 flex-grow-1 min-w-0 ".concat(S?"b--dark-pink":"b--black-10 hover-b--black-30"," ").concat(c),children:[(0,a.jsx)("div",{className:"bg-near-white b--black-10 br2 mid-gray ma0 pa2 truncate ".concat(p?"br--left br":"flex-grow-1"),children:"".concat(ce.host,"/").concat(v)}),p&&(0,a.jsx)("input",(0,n.Z)({type:"text",onInvalid:e=>e.preventDefault(),ref:Z,className:"ba0 br2 br--right pa2 bn near-black flex-grow-1",placeholder:r?(0,le.O)(s):"",disabled:d||!p,value:m,onInput:e=>h(e.target.value)},u))]}),(0,a.jsx)(D.kq,{className:"ml2","data-cy":"copy",onClick:function(){const e=new URL(v+m,ce);navigator.clipboard.writeText(e.href);const t=_;R("Copied URL to clipboard"),N(setTimeout((()=>{R(t)}),2e3))},text:"Copy"})]}),_&&(0,a.jsx)("div",{className:"dark-pink f7 fw4",children:_})]})};var ue=s(28925);const me=Object.values(te.c).map((e=>e.shorthand)),he=(0,M.ZV)((e=>{let{notebook:t,currentUser:s}=e;return{notebook:t,currentUser:s}}),(e=>({dispatch:e})))((e=>{let{notebook:t,dispatch:s,onDismiss:n}=e;const{0:i,1:l}=(0,L.useState)(""),{0:o,1:c}=(0,L.useState)(""),{0:d,1:u}=(0,L.useState)(!0),{publishLevel:h,thumbnail:b,defaultThumbnail:g}=t,x=(0,Z.fN)(t)||(0,Z.dO)(t.owner),p=(0,ee.Ui)("title"in t?t:t.model);(0,L.useEffect)((()=>{u("shared"!==h)}),[h]);const f=(0,L.useRef)(null),{0:v,1:j}=(0,L.useState)(!0);let w=!1;if("model"in t){const e=(0,se.Z)(t.model.nodes);w=e.databaseClients.size>0||e.secrets.size>0||Array.from(e.fileAttachments).some((e=>me.some((t=>e.startsWith("".concat(t,"://"))))))}return(0,a.jsx)(r.Vq,{onDismiss:n,"aria-labelledby":"modal-title",children:(0,a.jsxs)("form",{noValidate:!0,name:"publishForm",ref:f,onSubmit:e=>{e.preventDefault(),s({type:"publishRequested",unlisted:!d,customThumbnail:o,customSlug:i,live:x}),n()},children:[(0,a.jsx)(m.xB,{title:"Publish",icon:$.Z,onDismiss:n}),(0,a.jsxs)(m.fe,{children:[(0,a.jsx)(m.pe,{title:"Thumbnail"}),(0,a.jsxs)("div",{className:"flex flex-column",children:[(0,a.jsx)(ue.E,{thumbnail:b,defaultThumbnail:g,onValueChange:e=>{c(e),f.current&&j(f.current.checkValidity())}}),!x&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.pe,{title:"Visibility"}),(0,a.jsx)(Q.E,{name:"visibility",label:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"mr1",children:"Public"})," ",(0,a.jsx)($.Z,{})]}),checked:d,disabled:"public"===h,description:"Make discoverable on the Explore page and via Search",onChange:e=>u("on"===e.target.value)}),(0,a.jsx)(Q.E,{name:"visibility",id:"visibility_unlisted",label:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"mr1",children:"Unlisted"})," ",(0,a.jsx)(J.ZP,{})]}),checked:!d,disabled:"public"===h,description:"Only people with the URL will be able to view",onChange:e=>u("on"!==e.target.value)})]}),(0,a.jsx)(m.pe,{title:"Notebook URL"}),(0,a.jsx)("div",{children:(0,a.jsx)(de,{owner:t.owner,notebookId:t.id,title:p,slug:t.slug,isPublic:d,onValueChange:e=>{l(e),f.current&&j(f.current.checkValidity())}})})]})]}),(0,a.jsxs)(m.mz,{children:[w&&(0,a.jsx)(W.b,{type:"warning",className:"mb3",title:"Some features will stop working when you publish",description:"Database clients, cloud files, and secrets can only be used in private notebooks."}),(0,a.jsxs)(D.CQ,{children:[(0,a.jsx)(D.kq,{type:"reset",onClick:n,text:"Cancel"}),(0,a.jsx)(D.KM,{type:"submit",disabled:!v,text:"Publish"})]})]})]})})}));var be=s(21013),ge=s(75713);const xe=(0,M.ZV)((e=>{let{notebook:t}=e;return{notebook:t}}),(e=>({dispatch:e})))((e=>{let{notebook:t,dispatch:s,onDismiss:n}=e;const{0:i,1:l}=(0,L.useState)(""),{thumbnail:o,defaultThumbnail:c}=t,d=(0,L.useRef)(null),{0:u,1:h}=(0,L.useState)(!0),b=u&&(i||o!==t.defaultThumbnail)&&i!==o;return(0,a.jsx)(r.Vq,{onDismiss:n,"aria-labelledby":"modal-title",children:(0,a.jsxs)(ge.l,{ref:d,className:"relative f6 lh-copy",onSubmit:e=>{e.preventDefault(),s({type:"setNotebookThumbnail",customThumbnail:i}),n()},children:[(0,a.jsx)(m.xB,{title:"Set Thumbnail",icon:be.Z,onDismiss:n}),(0,a.jsx)(m.fe,{children:(0,a.jsx)("div",{className:"flex flex-column",children:(0,a.jsx)(ue.E,{thumbnail:o,defaultThumbnail:c,onValueChange:e=>{l(e),d.current&&h(d.current.checkValidity())}})})}),(0,a.jsx)(m.mz,{children:(0,a.jsxs)(D.CQ,{children:[(0,a.jsx)(D.kq,{text:"Cancel",onClick:n}),(0,a.jsx)(D.KM,{text:"Confirm",type:"submit",disabled:!b})]})})]})})}));var pe=s(18794);const fe=/^[0-9a-z_-]+(?:\/[0-9]+)?$/;var ve;!function(e){e[e.Empty=0]="Empty",e[e.Conflict=1]="Conflict",e[e.Invalid=2]="Invalid",e[e.TooLong=3]="TooLong",e[e.Available=4]="Available"}(ve||(ve={}));const je=(0,M.ZV)((e=>{let{notebook:t}=e;return{notebook:t}}),(e=>({dispatch:e})))((e=>{let{notebook:t,dispatch:s,onDismiss:n}=e;const{id:i,owner:l,slug:o}=t,c=(0,ee.Ui)("model"in t?t.model:t),[d,u,h]=(0,ne.G)(o||(0,le.O)(c),150),{0:b,1:g}=(0,L.useState)(ve.Available),[x]=(0,y.h_)((()=>h&&i&&(b===ve.Available||b===ve.Conflict)?"/document/".concat(i,"/slug-exists?slug=").concat(encodeURIComponent(h.replace(/\/$/,""))):null));function p(e){s({type:"setSlug",slug:e})}(0,L.useEffect)((()=>h?h.length>255?g(ve.TooLong):fe.exec(h)?(null===x||void 0===x?void 0:x.exists)?g(ve.Conflict):void g(ve.Available):g(ve.Invalid):g(ve.Empty)),[h,g,x]);const f=b===ve.Available,v=!f&&b!==ve.Empty;return(0,a.jsx)(r.Vq,{onDismiss:n,"aria-labelledby":"modal-title","data-dialog-wide":!0,children:(0,a.jsxs)(ge.l,{className:"relative f6 lh-copy",onSubmit:e=>{e.preventDefault(),p(d),n()},children:[(0,a.jsx)(m.xB,{title:"Set URL",icon:pe.Z,onDismiss:n}),(0,a.jsxs)(m.fe,{children:[(0,a.jsxs)("div",{className:"flex items-stretch br2 ba ".concat(v?"b--dark-pink":"b--black-10 hover-b--black-30"),children:[(0,a.jsxs)("div",{className:"pa2 pr0 pr1 black-70 bg-near-white br b--black-10 br2 br--left",onClick:()=>{var e;null===(e=document.querySelector("#slug"))||void 0===e||e.focus()},children:["observablehq.com/@",l.login,"/"]}),(0,a.jsx)("input",{id:"slug",placeholder:d,value:d,className:"pa2 black br2 flex-auto br--right bn",onChange:e=>u(e.target.value)})]}),v?(0,a.jsx)("div",{className:"pa1 mt1 f7 fw5 dark-pink",children:(j=b,j===ve.Conflict?"A notebook already exists at that URL.":j===ve.Invalid?"URL can only include lowercase alphanumeric characters, hyphens, underscores, and an optional forward slash suffix (/2).":j===ve.TooLong?"URL must be less than 255 characters long.":null)}):null]}),(0,a.jsx)(m.mz,{children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)(D.sn,{text:"Reset",destructive:!0,"data-cy":"reset-slug",onClick:e=>{e.preventDefault(),p(null),n()}}),(0,a.jsxs)(D.CQ,{children:[(0,a.jsx)(D.kq,{text:"Cancel",onClick:n}),(0,a.jsx)(D.KM,{text:"Confirm",type:"submit",disabled:!f})]})]})})]})});var j}));var we=s(17905),ye=s(54256),ke=s(87671),Ne=s(71043),Ce=s(55267);const Ze=e=>{let{description:t="",onValueChange:s}=e;const n=(0,L.useRef)(null),{0:i,1:l}=(0,L.useState)(t);return(0,L.useEffect)((()=>{s(i)}),[s,i]),(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"mv3",children:[(0,a.jsx)("div",{className:"mv2 fw5 dark-gray",children:"Set notebook description (internal use only)"}),(0,a.jsx)(I.g,{ref:n,name:"description",className:"db w-100",placeholder:"Enter notebook description. Currently only used for editorial purposes, e.g. our blog.",value:i,maxLength:300,onChange:e=>l(e.target.value)}),(0,a.jsx)("div",{className:"flex flex-column items-end mt2 gray f7 fw5",children:(0,a.jsx)("div",{children:"(".concat(i.length,"/").concat(300,")")})})]})})};var Se=s(95577),_e=s(14921),Le=s(80835);const Re=(e,t)=>{if(!e||!t)return{};const s=e.left+e.width/2-t.width/2,n=window.innerWidth-t.width-2;return{left:Math.min(Math.max(2,s),n)+window.scrollX,top:e.bottom+8+window.scrollY}},Me=e=>{let{children:t,className:s,label:l}=e;const[r,o]=(0,Le.lL)(),{isVisible:c,triggerRect:d}=o;return(0,a.jsxs)(a.Fragment,{children:[L.cloneElement(L.Children.only(t),r),c&&(0,a.jsx)(_e.h,{children:(0,a.jsx)("div",{className:"absolute z-5",style:{borderLeft:"".concat(10,"px solid transparent"),borderRight:"".concat(10,"px solid transparent"),borderBottom:"".concat(10,"px solid"),borderBottomColor:"var(--white)",height:0,left:d?d.left-10+d.width/2:"",marginBottom:1,top:d?d.bottom+window.scrollY:"",width:0}})}),(0,a.jsx)(Le.zG,(0,i.Z)((0,n.Z)({},o),{className:s,label:l,position:Re}))]})};var Ue=s(86723),Ee=s(20042),De=s(27919);const Te=null,Ae={avatar_url:null,bio:"",github_login:null,home_url:"",id:"0",login:"",name:"",pending:!0,role:Te,status:"member",team_role:null,tier:"basic",type:"team"};function Ve(e){return{avatar_url:e.avatar_url,bio:e.bio,github_login:e.github_login,home_url:e.home_url,id:e.id,login:e.login||e.id,name:e.name,pending:!0,role:null,status:"member",team_role:e.role,tier:e.tier,type:"individual"}}function Ie(e,t){return{avatar_url:e.avatar_url,bio:e.bio,github_login:"github_login"in e?e.github_login:null,home_url:e.home_url,id:e.id,login:e.login||e.id,name:e.name,pending:!0,role:t,status:"status"in e?e.status:"member",team_role:"team_role"in e?e.team_role:Te,tier:e.tier,type:"type"in e?e.type:"individual"}}function Fe(e,t){return t.find((t=>t.id===e.id))||Ie(e,Te)}function qe(e,t){switch(e){case"editor":return"team"===t.type?"Can view or edit":"Can edit";case"viewer":return"Can view";default:return"team"===t.type?"No access":"invited"!==t.status||t.pending?"Remove":"Rescind invitation"}}const Pe=e=>{const{member:t,roles:s,changeMemberRole:n}=e;return(0,a.jsx)(V.P,{name:"role_change",value:t.role||"",onChange:e=>{n(t,e.target.value?e.target.value:null)},disabled:s.length<=1,children:s.map((e=>(0,a.jsx)("option",{value:e||"",children:qe(e,t)},e)))})},ze="mr2 br-100 flex justify-center items-center dark-green bg-observable-washed-green",Oe=e=>{const{member:t,pendingMembers:s,memberCount:n,changeMemberRole:i,notebook:l,canAssignRoles:r,disclaimer:o,currentUser:c,liveSelected:d}=e,u=(0,L.useMemo)((()=>{const e=[];return r?("viewer"!==t.team_role&&e.push("editor"),function(){if("editor"!==t.role)return!1;const e=s.filter((e=>"editor"===e.role));if(1===e.length&&t.id===e[0].id)return!0;const n=(0,_.jR)(l.owner.id,c);if(!n||n.setting_publish_transfer||(0,Z.ws)(l))return!1;const i=e.filter((e=>"owner"===e.team_role||e.id===l.owner.id));return!(i.length>1||0===i.length)&&t.id===i[0].id}()||(e.push("viewer"),d&&t.role!==Te||e.push(Te))):(c.id===t.id&&e.push(Te),e.push(t.role)),e}),[r,l,c,s,t,d]),m=t.icon;return(0,a.jsxs)("div",{className:"flex f6 fw5 mb2 justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center min-w-0",children:["member"===t.status&&m?(0,a.jsx)("div",{className:ze,style:{width:28,height:28},children:(0,a.jsx)(m,{})}):(0,a.jsx)(E.q,{user:t,id:t.id,size:28,className:"mr2 br-100"}),"invited"===t.status&&(0,a.jsx)("div",{className:"mr2 br-100 bg-light-silver flex items-center justify-center",style:{height:28,width:28},children:(0,a.jsx)(Ce.Z,{height:16,className:"mid-gray"})}),(0,a.jsxs)("div",{className:"truncate ".concat(n?"flex-column":""),children:[(0,a.jsx)("span",{className:"near-black",children:t.name||t.login}),t.id===c.id?(0,a.jsx)("span",{className:"ml1 gray",children:"(You)"}):"invited"===t.status&&t.pending?(0,a.jsx)("span",{className:"truncate gray",children:"\xa0(Invite)"}):"invited"===t.status?(0,a.jsx)("span",{className:"truncate gray",children:"\xa0(Invited)"}):t.name&&t.name!==t.login&&(0,a.jsxs)("span",{className:"truncate gray",children:["\xa0(@",t.login,")"]}),n&&(0,a.jsx)("div",{className:"gray",children:"".concat(n," member").concat(1!==n?"s":"")})]})]}),(0,a.jsxs)("div",{className:"flex",children:[o&&(0,a.jsx)("div",{className:"flex items-center mr1",children:(0,a.jsx)(Me,{className:"".concat(Le.Xv," pa3 pre-line mw5"),label:o.message,children:(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(o.icon,{})})})}),t.id===l.owner.id&&"individual"===l.owner.type?(0,a.jsx)("div",{className:"gray pv2 bt bb b--transparent lh-default",children:"Owner"}):(0,a.jsx)(Pe,{member:t,changeMemberRole:i,roles:u})]})]})},Be=e=>{const{notebook:t,changePublishLevel:s,publishLevel:n}=e;return(0,a.jsxs)("div",{className:"flex f6 fw5 mb2 justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center min-w-0",children:[(0,a.jsx)("div",{className:ze,style:{width:28,height:28},children:(0,a.jsx)($.Z,{})}),(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"near-black",children:"Public"})})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[("public"===n||"shared"===n)&&(0,a.jsx)("div",{className:"flex items-center mr1",children:(0,a.jsx)(Me,{className:"".concat(Le.Xv," pa3 pre-line mw5"),label:(0,a.jsxs)(a.Fragment,{children:["A published or unlisted version of this notebook is visible to the public, but new edits are not.",(0,a.jsx)("p",{children:"Change this setting to make this notebook fully public or private."})]}),children:(0,a.jsx)("div",{children:(0,a.jsx)(ke.Z,{className:"w1 h1 mh2 gold bg-lightest-yellow flex-no-shrink br-pill"})})})}),(0,a.jsxs)(V.P,{name:"role_change",value:n,onChange:e=>s(e.target.value),disabled:!(0,C.zB)(t),children:[(0,a.jsx)("option",{value:"live",children:"Can view"}),((0,Z.nv)(t)||(0,C._l)(t))&&(0,a.jsx)("option",{value:"live_unlisted",children:"Can view (unlisted)"}),(0,Z.cg)(t)&&(0,a.jsx)("option",{value:"shared",children:"Can view unlisted published version"}),(0,Z.s9)(t)&&(0,a.jsx)("option",{value:"public",children:"Can view published version"}),((0,Z.ws)(t)||(0,C._l)(t))&&(0,a.jsx)("option",{value:"private",children:"No access"})]})]})]})},Xe=(0,M.ZV)((e=>{let{notebook:t,currentUser:s}=e;return{notebook:t,currentUser:s}}),(e=>({dispatch:e})))((e=>{const{notebook:t,currentUser:s}=e,l="team"===t.owner.type,[r]=(0,y.h_)("/document/".concat(t.id,"/members")),o=(0,L.useMemo)((()=>null===r||void 0===r?void 0:r.map((e=>(0,i.Z)((0,n.Z)({},e),{bio:"",github_login:null,home_url:"",pending:!1})))),[r]),[c]=(0,y.h_)(l?"/team/".concat(t.owner.id,"/members"):null),d=(0,L.useMemo)((()=>null===c||void 0===c?void 0:c.map(Ve)),[c]);return!o||l&&!d?null:(0,a.jsx)(Ye,(0,i.Z)((0,n.Z)({},e),{currentUser:s,documentMembers:o,teamMembers:d}))})),Ye=e=>{const{notebook:t,onDismiss:s,dispatch:n,documentMembers:i,teamMembers:l}=e,o=e.currentUser,c="team"===t.owner.type,{0:d,1:u}=(0,L.useState)("editor"),{0:h,1:b}=(0,L.useState)(null),{0:g,1:x}=(0,L.useState)(null),{0:p,1:f}=(0,L.useState)(null),{0:v,1:j}=(0,L.useState)(""),{defaultThumbnail:w,owner:y,thumbnail:k,publishLevel:N}=t,S=(0,Ue.X)(),_="public"===y.tier&&(null===S||void 0===S?void 0:S.id)===y.id,{0:R,1:M}=(0,L.useState)(!0),U=R&&(v||k!==t.defaultThumbnail)&&v!==k,E=R&&g!==t.slug,T=R&&null!==p&&"description"in t&&p!==t.description,I=(0,L.useRef)(null),F=h&&("invited"in h?{avatar_url:null,bio:"",github_login:null,home_url:"",id:h.login,name:"",login:h.login,pending:!0,role:Te,status:"invited",team_role:null,tier:"basic",type:"individual"}:Ie(h,Te)),{0:q,1:P}=(0,L.useState)([]),{0:z,1:O}=(0,L.useState)([]),{0:B,1:X}=(0,L.useState)(""),Y=(0,ee.Ui)("title"in t?t:t.model),{0:H,1:G}=(0,L.useState)(N),K="live"===H||"live_unlisted"===H;(0,L.useEffect)((()=>{P(i),O(i)}),[i]);const Q=q.filter((e=>"team"!==e.type&&!z.find((t=>t.id===e.id)))).length,J=Fe(o,z),te=Fe(o,q),ne=c?Fe(t.owner,z):Ae,ie=c?Fe(t.owner,q):Ae,le=Fe(t.owner,z),ae=q.filter((e=>e.id!==t.owner.id&&e.id!==o.id)),re=!c&&"model"in t&&(0,se.Z)(t.model.nodes),oe=re&&(re.databaseClients.size>0||re.secrets.size>0),ce=z.length===q.length&&z.every((e=>q.some((t=>e.id===t.id&&t.role===e.role))));function me(e){return"team"!==e.type||q.some((e=>"individual"===e.type&&"editor"===e.role))?"editor"===ie.role&&"viewer"===e.role&&"viewer"!==e.team_role?{icon:De.Z,message:"This user can still edit the notebook because they\u2019re an editor in the team it\u2019s shared with."}:"individual"===t.owner.type&&(0,Z.ws)(t)&&"public"===e.tier&&!K?{icon:ye.Z,message:"This user will need to upgrade to Pro to view this private notebook.\n\nAlternatively, set Public to \u201cCan view\u201d to collaborate with Free users in public."}:void 0:{icon:Ne.Z,message:"Notebooks must have at least one editor."}}function he(e,t){const s=q.findIndex((t=>t.id===e.id)),n=Ie(e,t);if(s>-1)if(t!==Te){const e=Array.from(q);e[s]=n,P(e)}else P(q.filter((t=>t.id!==e.id)));else P([...q,n])}const be=("editor"===J.role||"editor"===ne.role)&&"editor"!==te.role&&"editor"!==ie.role,ge=te.role===Te&&ie.role===Te;function xe(e){if(e.preventDefault(),U&&n({type:"setNotebookThumbnail",customThumbnail:v}),E&&n({type:"setSlug",slug:g||null}),T&&n({type:"descriptionUpdate",description:p,onDismiss:s}),!ce){const e=ge?[]:be?["viewer"]:t.roles.filter((e=>!(K&&"readonly"===e)));n({type:"share",currentMembers:z,newMembers:q,newRoles:e,message:B})}H!==N&&n(K?{type:"publishLiveRequested",unlisted:"live_unlisted"===H}:{type:"unpublishRequested"}),s()}const pe=(0,C.sZ)(t),fe=!c&&q.length>=5;return(0,a.jsx)(r.Vq,{onDismiss:s,"aria-labelledby":"modal-title",children:(0,a.jsxs)("form",{noValidate:!0,name:"publishForm",ref:I,onSubmit:xe,children:[(0,a.jsx)(m.xB,{title:"Share",icon:$.Z,onDismiss:s}),"private"!==t.publishLevel&&"private"===H&&(0,a.jsxs)("aside",{className:"pa3 pb2 flex bg-observable-dark-gold white",children:[(0,a.jsx)("div",{children:(0,a.jsx)(ye.Z,{className:"mr2",width:16})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"fw6",children:"Making this notebook private will cause any imports of cells from this notebook to fail."})," ","If you want to work on substantial edits to this notebook, consider forking then merging those changes instead.",(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(D.Q4,{className:"white",colorless:!0,href:"/@observablehq/fork-suggest-merge?collection=@observablehq/editing-publishing-collaborating",icon:we.Z,iconOnRight:!0,targetBlank:!0,text:"Learn more"})})]})]}),(0,a.jsxs)(m.fe,{children:[(0,C.mO)(t)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.pe,{className:"mt0",title:"Notebook URL"}),(0,a.jsx)(de,{owner:t.owner,notebookId:t.id,title:Y,slug:t.slug,isPublic:"public"===t.publishLevel&&!K,onValueChange:e=>{x(e),I.current&&M(I.current.checkValidity())}})]}),(0,a.jsxs)("div",{className:"mb3",children:[(0,a.jsx)(m.pe,{title:"Access"}),_&&(0,a.jsx)(Se.N,{size:"large",user:S})]}),(0,a.jsxs)("div",{className:"mb2",children:[(0,a.jsx)(Be,{publishLevel:H,notebook:t,changePublishLevel:e=>{G(e),K&&c&&ie.role===Te&&he(ie,"viewer")}}),c&&(0,a.jsx)(Oe,{member:ie,pendingMembers:q,liveSelected:K,notebook:t,canAssignRoles:pe,memberCount:null===l||void 0===l?void 0:l.length,changeMemberRole:he,currentUser:o,disclaimer:me(ie)}),!c&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(Oe,{member:le,pendingMembers:q,notebook:t,canAssignRoles:pe,changeMemberRole:he,currentUser:o})}),(0,a.jsx)("div",{className:"w-100 overflow-auto",style:{maxHeight:250},children:te.role||ae.length?(0,a.jsxs)(a.Fragment,{children:[te.role&&te.id!==t.owner.id&&(0,a.jsx)(Oe,{member:te,pendingMembers:q,notebook:t,canAssignRoles:pe,changeMemberRole:he,disclaimer:me(te),currentUser:o}),ae.map((e=>(0,a.jsx)(Oe,{member:e,pendingMembers:q,notebook:t,canAssignRoles:pe,changeMemberRole:he,disclaimer:me(e),currentUser:o},e.id)))]}):c?(0,a.jsx)("div",{className:"f7 fw5 gray",style:{padding:"15px 0"},children:"No team members have been granted individual access to this notebook."}):t.owner.id===o.id?(0,a.jsx)("div",{className:"f7 fw5 gray",style:{padding:"15px 0"},children:"Only you can make changes to this notebook."}):(0,a.jsx)("div",{className:"f7 fw5 gray",style:{padding:"15px 0"},children:"You will no longer have access to this notebook."})})]}),pe&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(Ee.o,{value:h,type:"individual",className:"flex items-center flex-grow-1 min-w-0",universe:l,excluded:q,placeholder:c?"Search for a teammate":"User to share with, or email to invite",disabled:fe,allowEmail:!c,onSelectUser:e=>{const t=e&&!("invited"in e)&&(null===l||void 0===l?void 0:l.some((t=>t.id===e.id&&"viewer"===t.team_role)));b(e),u(t?"viewer":"editor")}}),(0,a.jsxs)(V.P,{value:d,onChange:e=>u(e.target.value),disabled:fe||!F,className:"mh2 f6 fw5",children:[(!F||"viewer"!==F.team_role)&&(0,a.jsx)("option",{value:"editor",children:"Can edit"}),(0,a.jsx)("option",{value:"viewer",children:"Can view"})]}),(0,a.jsx)(D.aX,{text:"Add",onClick:function(){null!==F&&(he(F,d),b(null))},disabled:!F,"data-cy":"add-user"})]}),fe&&(0,a.jsx)("div",{className:"mv1 pl2 f7 mid-gray",style:{marginLeft:1},children:"Personal notebooks can be shared with up to four people"}),Q>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.pe,{className:"mt3",title:"Invitation message"}),(0,a.jsx)("div",{className:"flex flex-row items-center self-start w-100",children:(0,a.jsx)(A.Z,{className:"w-100",type:"text",placeholder:"Optional message to ".concat(Q," new member").concat(1===Q?"":"s"),value:B,onChange:e=>X(e.target.value),onKeyDown:e=>{"Enter"===e.key&&xe(e)},maxLength:255})})]})]}),(0,C.fW)(t)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.pe,{title:"Thumbnail"}),(0,a.jsx)(ue.E,{thumbnail:k,defaultThumbnail:w,onValueChange:e=>{j(e),I.current&&M(I.current.checkValidity())}})]}),(0,C.qG)(o,t)&&"description"in t&&(0,a.jsx)(Ze,{description:t.description,onValueChange:f})]}),(0,a.jsxs)(m.mz,{children:[ge||be?(0,a.jsx)(W.b,{type:"warning",title:"You'll no longer be able to ".concat(ge?"access":"edit"," this notebook"),description:"Please make changes to the roles above if you wish to retain your current access.",className:"mb3"}):null,oe?(0,a.jsx)(W.b,{type:"warning",title:"Database clients and secrets will stop working when you share",description:"These features can be used only in private notebooks.",className:"mb3"}):null,(0,a.jsxs)(D.CQ,{children:[(0,a.jsx)(D.kq,{onClick:s,text:"Cancel"}),(0,a.jsx)(D.KM,{type:"submit",disabled:!R,text:"Save"})]})]})]})})};var He=s(2537),Ge=s(84193),Ke=s(21249),We=s(37724);const Qe=e=>{const{member:t,pendingMembers:s,memberCount:n,changeMemberRole:i,notebook:l,canAssignRoles:r,showDisclaimer:o=!1,currentUser:c}=e,d=(0,L.useMemo)((()=>{const e=[];return r?("viewer"!==t.team_role&&e.push("editor"),function(){if("editor"!==t.role)return!1;const e=s.filter((e=>"editor"===e.role));if(1===e.length&&t.id===e[0].id)return!0;const n=(0,_.jR)(l.owner.id,c);if(!n||n.setting_publish_transfer||(0,Z.ws)(l))return!1;const i=e.filter((e=>"owner"===e.team_role||e.id===l.owner.id));return!(i.length>1||0===i.length)&&t.id===i[0].id}()||e.push("viewer",Te)):(c.id===t.id&&e.push(Te),e.push(t.role)),e}),[r,l,c,s,t]);return(0,a.jsxs)("div",{className:"flex f6 fw5 pv2 justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center min-w-0",children:["member"===t.status&&(0,a.jsx)(E.q,{user:t,id:t.id,size:28,className:"mr2 br-100"}),"invited"===t.status&&(0,a.jsx)("div",{className:"mr2 br-100 bg-light-silver flex items-center justify-center",style:{height:28,width:28},children:(0,a.jsx)(Ce.Z,{height:16,className:"mid-gray"})}),(0,a.jsxs)("div",{className:"truncate ".concat(n?"flex-column":""),children:[(0,a.jsx)("span",{className:"near-black",children:t.name||t.login}),t.id===c.id?(0,a.jsx)("span",{className:"ml1 gray",children:"(You)"}):"invited"===t.status&&t.pending?(0,a.jsx)("span",{className:"truncate gray",children:"\xa0(Invite)"}):"invited"===t.status?(0,a.jsx)("span",{className:"truncate gray",children:"\xa0(Invited)"}):t.name&&t.name!==t.login&&(0,a.jsxs)("span",{className:"truncate gray",children:["\xa0(@",t.login,")"]}),n&&(0,a.jsx)("div",{className:"gray",children:"".concat(n," member").concat(1!==n?"s":"")})]})]}),(0,a.jsxs)("div",{className:"flex",children:[o&&(0,a.jsx)("span",{className:"flex items-center",title:"This user can still edit the notebook because they\u2019re an editor in the team it\u2019s shared with.",children:(0,a.jsx)(De.Z,{})}),t.id===l.owner.id&&"individual"===l.owner.type?(0,a.jsx)("div",{className:"gray",children:"Owner"}):(0,a.jsx)(Pe,{member:t,changeMemberRole:i,roles:d})]})]})},$e=(0,M.ZV)((e=>{let{notebook:t,currentUser:s}=e;return{notebook:t,currentUser:s}}),(e=>({dispatch:e})))((e=>{const{notebook:t,currentUser:s}=e,l="team"===t.owner.type,[r]=(0,y.h_)("/document/".concat(t.id,"/members")),o=(0,L.useMemo)((()=>null===r||void 0===r?void 0:r.map((e=>(0,i.Z)((0,n.Z)({},e),{bio:"",github_login:null,home_url:"",pending:!1})))),[r]),[c]=(0,y.h_)(l?"/team/".concat(t.owner.id,"/members"):null),d=(0,L.useMemo)((()=>null===c||void 0===c?void 0:c.map(Ve)),[c]);return!o||l&&!d?null:(0,a.jsx)(Je,(0,i.Z)((0,n.Z)({},e),{currentUser:s,documentMembers:o,teamMembers:d}))})),Je=e=>{const{notebook:t,onDismiss:s,dispatch:l,documentMembers:o,teamMembers:c}=e,d=e.currentUser,u="team"===t.owner.type,{0:h,1:b}=(0,L.useState)("editor"),{0:g,1:x}=(0,L.useState)(null),p=g&&("invited"in g?{avatar_url:null,bio:"",github_login:null,home_url:"",id:g.login,name:"",login:g.login,pending:!0,role:Te,status:"invited",team_role:null,tier:"basic",type:"individual"}:Ie(g,Te)),{0:f,1:v}=(0,L.useState)([]),{0:j,1:w}=(0,L.useState)([]),{0:y,1:k}=(0,L.useState)("");(0,L.useEffect)((()=>{v(o),w(o)}),[o]);const N=f.filter((e=>"team"!==e.type&&!j.find((t=>t.id===e.id)))).length,Z=Fe(d,j),S=Fe(d,f),_=u?Fe(t.owner,j):Ae,R=u?Fe(t.owner,f):Ae,M=Fe(t.owner,j),U=f.filter((e=>e.id!==t.owner.id&&e.id!==d.id)),E=!u&&"model"in t&&(0,se.Z)(t.model.nodes),T=E&&(E.databaseClients.size>0||E.secrets.size>0),I=j.length===f.length&&j.every((e=>f.some((t=>e.id===t.id&&t.role===e.role))));function F(e){return"editor"===R.role&&"viewer"===e.role&&"viewer"!==e.team_role}function q(e,t){const s=f.findIndex((t=>t.id===e.id)),n=Ie(e,t);if(s>-1)if(t!==Te){const e=Array.from(f);e[s]=n,v(e)}else v(f.filter((t=>t.id!==e.id)));else v([...f,n])}const P=("editor"===Z.role||"editor"===_.role)&&"editor"!==S.role&&"editor"!==R.role,z=S.role===Te&&R.role===Te;function O(){const e=z?[]:P?["viewer"]:t.roles;l({type:"share",currentMembers:j,newMembers:f,newRoles:e,message:y}),s()}const B=(0,C.sZ)(t),X=!u&&f.length>=5;return(0,a.jsxs)(r.Vq,{onDismiss:s,"aria-labelledby":"modal-title",children:[(0,a.jsx)(m.xB,{title:"Share",icon:He.Z,onDismiss:s}),(0,a.jsxs)(m.fe,{children:[u&&(0,a.jsxs)(a.Fragment,{children:["Assign a role to your entire team or to individual team members."," ",(0,a.jsx)(Ge.Z,{href:"/@observablehq/permissions-for-teams-notebooks",children:(0,a.jsx)("a",{className:"blue",children:"Learn more"})}),".",(0,a.jsx)(m.pe,{title:"Entire team"}),(0,a.jsx)("div",{className:"ml1",children:(0,a.jsx)(Qe,{member:R,pendingMembers:f,notebook:t,canAssignRoles:B,memberCount:null===c||void 0===c?void 0:c.length,changeMemberRole:q,currentUser:d})}),(0,a.jsx)(m.pe,{title:"Team members"})]}),!u&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb2",children:["Personal notebooks can be shared with up to 4 people."," ",(0,a.jsx)(Ge.Z,{href:"/@observablehq/personal-sharing",children:(0,a.jsx)("a",{className:"blue",children:"Learn more"})})," ","or"," ",(0,a.jsx)(Ge.Z,{href:"/team/new",children:(0,a.jsx)("a",{className:"blue",onClick:function(){const e={notebookId:t.id,members:f.filter((e=>"individual"===e.type&&e.id!==d.id)).map((e=>(0,i.Z)((0,n.Z)({},"invited"===e.status?{email:e.login}:{login:e.login}),{role:"owner"===e.role?"owner":"editor"===e.role?"member":"viewer"})))};We.y.setItem(Ke.X,JSON.stringify(e))},children:"create a team"})})," ","to share this notebook with more people."]}),(0,a.jsx)("div",{className:"ml1",children:(0,a.jsx)(Qe,{member:M,pendingMembers:f,notebook:t,canAssignRoles:B,changeMemberRole:q,currentUser:d})})]}),(0,a.jsx)("div",{className:"overflow-hidden",children:(0,a.jsx)("div",{className:"w-100 overflow-auto",style:{maxHeight:250},children:(0,a.jsx)("div",{className:"ml1",children:S.role||U.length?(0,a.jsxs)(a.Fragment,{children:[S.role&&S.id!==t.owner.id&&(0,a.jsx)(Qe,{member:S,pendingMembers:f,notebook:t,canAssignRoles:B,changeMemberRole:q,showDisclaimer:F(S),currentUser:d}),U.map((e=>(0,a.jsx)(Qe,{member:e,pendingMembers:f,notebook:t,canAssignRoles:B,changeMemberRole:q,showDisclaimer:F(e),currentUser:d},e.id)))]}):u?(0,a.jsx)("div",{className:"f7 fw5 gray",style:{padding:"15px 0"},children:"No team members have been granted individual access to this notebook."}):t.owner.id===d.id?(0,a.jsx)("div",{className:"f7 fw5 gray",style:{padding:"15px 0"},children:"Only you can make changes to this notebook."}):(0,a.jsx)("div",{className:"f7 fw5 gray",style:{padding:"15px 0"},children:"You will no longer have access to this notebook."})})})}),B&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex pt2",children:[(0,a.jsx)(Ee.o,{value:g,type:"individual",className:"flex items-center flex-grow-1",universe:c,excluded:f,placeholder:u?"Search for a teammate":"User to share with, or email to invite",disabled:X,allowEmail:!u,onSelectUser:e=>{const t=e&&!("invited"in e)&&(null===c||void 0===c?void 0:c.some((t=>t.id===e.id&&"viewer"===t.team_role)));x(e),b(t?"viewer":"editor")}}),(0,a.jsxs)(V.P,{value:h,onChange:e=>b(e.target.value),disabled:X||!p,className:"mh2 f6 fw5",children:[(!p||"viewer"!==p.team_role)&&(0,a.jsx)("option",{value:"editor",children:"Can edit"}),(0,a.jsx)("option",{value:"viewer",children:"Can view"})]}),(0,a.jsx)(D.aX,{text:"Add",onClick:function(){null!==p&&(q(p,h),x(null))},disabled:!p,"data-cy":"add-user"})]}),N>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.pe,{title:"Invitation message"}),(0,a.jsx)("div",{className:"flex flex-row items-center self-start w-100 pt1",children:(0,a.jsx)(A.Z,{className:"w-100",type:"text",placeholder:"Optional message to ".concat(N," new member").concat(1===N?"":"s"),value:y,onChange:e=>k(e.target.value),onKeyDown:e=>{"Enter"===e.key&&O()},maxLength:255})})]}),X&&(0,a.jsx)("div",{className:"ma1 fw6 gray",children:"Personal sharing limit reached"})]})]}),(0,a.jsxs)(m.mz,{children:[z||P?(0,a.jsx)(W.b,{type:"warning",title:"You'll no longer be able to ".concat(z?"access":"edit"," this notebook"),description:"Please make changes to the roles above if you wish to retain your current access.",className:"mb3"}):null,T?(0,a.jsx)(W.b,{type:"warning",title:"Database clients and secrets will stop working when you share",description:"These features can be used only in private notebooks.",className:"mb3"}):null,(0,a.jsxs)(D.CQ,{children:[(0,a.jsx)(D.kq,{onClick:s,text:"Cancel"}),(0,a.jsx)(D.KM,{"data-cy":"confirm",onClick:O,disabled:I,text:"Confirm"})]})]})]})};var et=s(8433);const tt=U((e=>{let{notebook:t}=e;return{notebook:t}}),(e=>({dispatch:e})))((e=>{let{notebook:t,relocate:s,dispatch:n,onDismiss:i}=e;return(0,a.jsx)(m.On,{title:"Move to trash",icon:et.Z,description:"Are you sure you want to move this notebook to the trash? Notebooks can be removed from the trash for 30 days before they are permanently deleted.",onCancel:i,onConfirm:()=>{i(),n({type:"trashRequested",trashed:!0,relocate:s})},isConfirming:t.isUpdatingTrash,destructive:!0})}));var st=s(4647);const nt=U((e=>{let{notebook:t}=e;return{notebook:t}}),(e=>({dispatch:e})))((e=>{let{dispatch:t,onDismiss:s}=e;return(0,a.jsx)(m.On,{title:"Unpublish",icon:st.Z,description:"Are you sure you want to unpublish this notebook? Access to this notebook will be restricted, and any links or imports may break.",onCancel:s,onConfirm:()=>{s(),t({type:"unpublishRequested"})},destructive:!0})})),it=(0,i.Z)((0,n.Z)({},l.V),{publishConfirmation:he,setSlug:je,share:Xe,sharing:$e,trash:tt,unpublish:nt,fork:G.e1,forkWithComments:e=>{let{onConfirm:t,onDismiss:s}=e;return(0,a.jsx)(m.On,{title:"Continue with fork",icon:K.Z,description:"Your unsaved comments will be lost if you fork. Are you sure you want to continue?",onCancel:s,onConfirm:()=>{s(),t()}})},collections:X,setNotebookThumbnail:xe,tableOperation:v,transfer:G.Zd})},21249:function(e,t,s){s.d(t,{X:function(){return n}});const n="newTeam"}}]);