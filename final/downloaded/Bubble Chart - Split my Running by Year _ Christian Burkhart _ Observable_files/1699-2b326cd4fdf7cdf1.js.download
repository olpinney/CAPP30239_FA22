"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1699],{60803:function(e,t,n){var o=n(41799),r=n(69396),s=n(85893);n(67294);t.Z=e=>(0,s.jsx)("svg",(0,r.Z)((0,o.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:(0,s.jsx)("path",{d:"M13 6.5L8 12L3 6.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}))},11331:function(e,t,n){n.d(t,{V:function(){return W}});var o=n(85893),r=n(65988),s=n.n(r),i=n(94184),a=n.n(i),c=n(60803),l=n(2461),d=n(88398),u=n(18776),p=n(918),b=n(19799),m=n(69935),v=n(95414),f=n(81416),h=n(74834),g=n(55917),y=n(1504),k=n(26599),x=n(84839),w=n(62841);const R={empty:{background:"rgba(211, 152, 23, .4)",rect:"rgb(211, 152, 23)",text:"#8D640D",stroke:"none"},unique:{background:"#E2E2E2",rect:"#E2E2E2",text:"#6E6E6E",stroke:"none"},default:{background:"rgba(123,146,209, .4)",rect:"rgba(123,146,209)",text:"#2B50B0",stroke:"#97BBF4"}};function S(e){const t=(0,b.WU)(".2p");return"100%"===t(e)&&1!==e?">99%":t(e)}function U(e){return(0,b.WU)(",")(e)}function _(e){let t=2;const n=Math.abs(e[1])<1?"~f":"~s";let o=(0,b.WU)(",.".concat(t).concat(n));for(;o(e[0])===o(e[1])&&t<8;)t++,o=(0,b.WU)(",.".concat(t).concat(n));return o}function M(e){return e[1]>m.Z.offset(e[0],1)?(0,w.g0)("'%y"):e[1]>v.Z.offset(e[0],1)?(0,w.g0)("%b '%y"):e[1]>f.Ox.offset(e[0],1)?(0,w.g0)("%b %e"):e[1]>h.Z.offset(e[0],1)?(0,w.g0)("%a %e"):e[1]>g.Z.offset(e[0],1)?(0,w.g0)("%I %p"):e[1]>y.Z.offset(e[0],1)?(0,w.g0)("%I:%M"):e[1]>k.Z.offset(e[0],1)?(0,w.g0)(":%S"):e[1]>x.Z.offset(e[0],1)?(0,w.g0)(".%L"):(0,w.g0)("%a %e")}const j=e=>{let{color:t="var(--observable-mid-gray)",text:n="Some values",backgroundColor:r="#E2E2E2",height:s=30,width:i=160}=e;return(0,o.jsx)("div",{className:"tc observable-mid-gray flex justify-center items-center fw4 sans-serif",style:{height:s,maxWidth:i,border:"1px solid ".concat(r),color:t,marginTop:"4px",borderRadius:"5px",paddingLeft:10,paddingRight:10,overflow:"hidden"},children:n.length>22?"".concat(n.slice(0,22),"\u2026"):n})};var V=n(67294);const C=e=>{let{data:t,type:n,typeLabel:r,height:s=50,width:i=130,insetLeft:a=.5,insetRight:c=.5,numMissing:b=0,nRows:m=6,formatter:v=String,hoveredValue:f}=e;const{0:h,1:g}=(0,V.useState)(-1),y=e=>{const t=O.invert(e.nativeEvent.offsetX),n=(0,l.ml)(C,t)-1;g(n)};function k(e){let{data:t}=e;return(0,o.jsx)("rect",{x:O(null===t||void 0===t?void 0:t.x1),width:O(null===t||void 0===t?void 0:t.x2)-O(null===t||void 0===t?void 0:t.x1)-a-c,height:2,fill:"black",y:s+1,pointerEvents:"none"})}const x=1===t.length&&(t[0].x1===t[0].x2||b>0),w=1===t.length&&b>0,{x1:C,xMin:E,xMax:P,xLabelMax:D,xScale:O,yScale:I,hoveredFormat:N}=(0,V.useMemo)((()=>{var e,o,r,a;const c=t.map((e=>void 0===e.x1?0:e.x1));var l;const m=null!==(l=(0,d.Z)(t,(e=>e.x1)))&&void 0!==l?l:0;var v;const f=null!==(v=(0,u.Z)(t,(e=>e.x2)))&&void 0!==v?v:1,h=(0,p.Z)().domain([m,f]).range([0,i]);var g;const y=0===b?f:null!==(g=(0,u.Z)(t.slice(0,-1),(e=>e.x2)))&&void 0!==g?g:1,k=(0,u.Z)([b||0,(0,u.Z)(t,(e=>e.count))||0]);return{x1:c,xMin:m,xMax:f,xLabelMax:y,xScale:h,yScale:(0,p.Z)().domain([0,k]).range([s,0]),hoveredFormat:"date"===n?M([new Date((null===(e=t[0])||void 0===e?void 0:e.x1)||0),new Date((null===(o=t[0])||void 0===o?void 0:o.x2)||0)]):_([(null===(r=t[0])||void 0===r?void 0:r.x1)||0,(null===(a=t[0])||void 0===a?void 0:a.x2)||0])}}),[t,i,s,b,n]),L="symbol"!==typeof f,Z=-1===h?null:t[h],F=-1===h?E:(null===Z||void 0===Z?void 0:Z.x1)||0,T=-1===h?P:(null===Z||void 0===Z?void 0:Z.x2)||0,q="date"===n?M([new Date(F||0),new Date(T||0)]):_([F||0,T||0]);var A,B,W,H;return(0,o.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,o.jsx)("div",{className:"mid-gray fw4",style:{marginBottom:"5px"},children:-1===h?r:Z&&(0,o.jsxs)(o.Fragment,{children:[U(Z.count)," ",1===Z.count?"row":"rows"," (".concat(S((Z.count||0)/m),")")]})}),x&&(0,o.jsx)(j,{backgroundColor:w?R.empty.background:R.default.background,color:w?R.empty.text:R.default.text,height:s,text:w?"all values: NULL/EMPTY":"all values: ".concat(v(t[0].x1||0))}),!x&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("svg",{style:{overflow:"visible"},height:s,width:i,children:[t.map(((e,n)=>(0,o.jsx)("rect",{x:O(e.x1),width:Math.max(0,O(e.x2)-O(e.x1)-a-c),height:0===e.count?0:(0,u.Z)([1,I(0)-I(e.count)]),y:0===e.count?I(0):(0,d.Z)([I(e.count),I(0)-1]),fill:n===t.length-1&&b>0?R.empty.rect:R.default.rect,fillOpacity:L||n!==h&&-1!==h?.4:1},n))),(0,o.jsx)("line",{y1:s+1,y2:s+1,x1:0,x2:O(D),strokeWidth:.5,stroke:"#d3d3d3"}),(0,o.jsx)("rect",{onPointerEnter:y,onPointerMove:y,onPointerLeave:function(){g(-1)},width:i+30,height:s+20,fillOpacity:.1,fill:"white"}),L&&(b>0&&(null===f||Number.isNaN(f))?(0,o.jsx)(k,{data:t[t.length-1]}):(0,o.jsx)("line",{x1:O(f),x2:O(f),y1:0,y2:s,strokeWidth:2,stroke:R.default.rect})),-1!==h&&(0,o.jsx)(k,{data:Z}),b>0&&(h===t.length-1||-1===h)&&(0,o.jsx)("text",{className:"fw4",x:O((t[t.length-1].x1||0)+((t[t.length-1].x2||0)-(t[t.length-1].x1||0))/2),y:s+15,fill:R.empty.rect,textAnchor:"middle",children:"\u2300"})]}),(0,o.jsxs)("div",{className:"fw4 bg-white relative mid-gray",style:{pointerEvents:"none",zIndex:-1},children:[!(L&&(null===f||Number.isNaN(f)))&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"bg-white absolute",style:{left:"".concat(O(null!==(A=null===Z||void 0===Z?void 0:Z.x1)&&void 0!==A?A:E),"px"),transform:Z?"translate(-100%, 0)":"",color:h===t.length-1&&b?R.empty.rect:"#555555"},children:h===t.length-1&&b?"NULL/EMPTY":q(null!==(B=null===Z||void 0===Z?void 0:Z.x1)&&void 0!==B?B:E)}),(0,o.jsx)("div",{className:"bg-white absolute",style:{left:"".concat(O(null!==(W=null===Z||void 0===Z?void 0:Z.x2)&&void 0!==W?W:D),"px"),transform:Z?"translate(0, 0)":"translate(-100%, 0)"},children:h===t.length-1&&b?"":q(null!==(H=null===Z||void 0===Z?void 0:Z.x2)&&void 0!==H?H:D)})]}),L&&(b>0&&(null===f||Number.isNaN(f))?(0,o.jsx)("div",{className:"bg-white absolute",style:{left:"".concat(O(t[t.length-1].x1),"px"),transform:"translate(-100%, 0)",color:R.empty.rect},children:"NULL/EMPTY"}):(0,o.jsx)("div",{className:"bg-white absolute",style:{left:"".concat(O(f),"px"),paddingLeft:"4px",paddingRight:"4px",borderRadius:"5px",transform:"translate(-50%, 0)",color:"rgb(44, 85, 172)"},children:N(f)}))]})]})]})};var E=n(41799),P=n(69396),D=n(72255),O=n(40477),I=n(98837),N=n(84236);const L=e=>{let{data:t,height:n=50,isUnique:r=!1,numCategories:s,width:i=130,typeLabel:a,hoveredValue:c}=e;var d,u,b;const{0:m,1:v}=(0,V.useState)(-1),f=e=>{const t=e.nativeEvent.offsetX<5?1:e.nativeEvent.offsetX-5,n=y.invert(t),o=(0,l.Nw)(g,n)-1;v(o)};function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rect";return null===e?R.empty[t]:e.includes("unique value")?R.unique[t]:R.default[t]}const{x1:g,xScale:y,total:k,allScaled:x,displayData:w}=(0,V.useMemo)((()=>{const e=t.map((e=>e.x1)),n=(0,p.Z)().domain([0,1]).range([0,i]),o=(0,D.Z)(t,(e=>e.count)),r=t.map((e=>(0,E.Z)({width:n(e.x2-e.x1)},e))),s=r.findIndex((e=>null===e.label)),a=r.findIndex((e=>{var t;return null===(t=e.label)||void 0===t?void 0:t.includes("unique value")})),c=r.filter(((e,t)=>t!==s&&t!==a)),l=(0,O.Z)(I.Z).right(c.map((e=>e.width)),2),d=c.slice(0,l);return l<c.length-1&&d.push(c.slice(l,c.length).reduce(((e,t)=>({label:"small display",x1:0,x2:0,count:e.count+t.count,width:e.width+t.width})))),a>=0&&d.push(r[a]),s>=0&&d.push(r[s]),{x1:e,xScale:n,total:o,allScaled:r,displayData:d}}),[t,i]);(0,V.useEffect)((()=>{if(c===N.V8)return void v(-1);const e=null===c||""===c?null:c;var n;const o=null!==(n=t.find((t=>t.label===e)))&&void 0!==n?n:t.find((e=>{var t;return-1!==(null===(t=e.label)||void 0===t?void 0:t.indexOf("unique value"))}));var r;const s=null!==(r=null===o||void 0===o?void 0:o.x1)&&void 0!==r?r:0,i=(0,l.Nw)(g,s);v(i)}),[c,g,t]);const _=-1===m?null:x[m];var M;return(0,o.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,o.jsx)("div",{className:"mid-gray fw4",style:{marginBottom:"5px",maxWidth:"".concat(i,"px")},children:(0,o.jsx)("div",{style:{width:"fit-content",background:"white"},children:-1===m||r||1===s?a:_&&(0,o.jsxs)(o.Fragment,{children:[U(_.count)," ",1===_.count?"row":"rows"," (".concat(S((_.count||k)/k),")")]})})}),(r||1===s)&&(0,o.jsx)(j,{height:n,backgroundColor:null===t[0].label?R.empty.background:(null===(d=t[0].label)||void 0===d?void 0:d.includes("unique value"))?R.unique.background:R.default.background,color:(null===(u=t[0].label)||void 0===u?void 0:u.includes("unique value"))?R.unique.text:null===t[0].label?R.empty.text:R.default.text,text:(null===(b=t[0].label)||void 0===b?void 0:b.includes("unique value"))?t[0].label:null===t[0].label?"all values: NULL/EMPTY":'all values: "'.concat(t[0].label,'"')}),!r&&s>1&&(0,o.jsxs)("div",{style:{position:"relative"},children:[(0,o.jsxs)("div",{style:{width:i,height:n,marginBottom:"3px",display:"flex",borderRadius:"5px",overflow:"hidden"},children:[w.map((e=>{var t,r;return(0,o.jsx)("div",{className:"flex items-center fw4 sans-serif",style:(0,P.Z)((0,E.Z)({},"small display"===e.label&&{background:"repeating-linear-gradient(\n                        to right,\n                        ".concat(R.default.rect," 0px,\n                        ").concat(R.default.rect," 1px,\n                        ").concat(R.default.stroke," 1px,\n                        ").concat(R.default.stroke," 2px\n                      )")}),{width:e.width,height:n,borderRight:"1px solid ".concat(h(e.label,"stroke")),backgroundColor:h(e.label,"rect"),opacity:-1===m||(null===_||void 0===_?void 0:_.label)===e.label&&(null===_||void 0===_?void 0:_.width)>=1?1:.4,textAlign:"center"}),children:e.count/k>.25&&"small display"!==e.label&&(0,o.jsxs)("span",{style:{overflow:"hidden",width:"100%",boxSizing:"border-box",padding:"0px 3px 0px 3px",color:(null===(t=e.label)||void 0===t?void 0:t.includes("unique value"))?R.unique.text:(e.label,"white")},children:[S(e.count/k)," ",e.count/k>.8?(null===(r=e.label)||void 0===r?void 0:r.includes("unique value"))?"unique":e.label:""]})},e.label)})),(null===_||void 0===_?void 0:_.width)<2&&(0,o.jsx)("div",{style:{width:i*((null===_||void 0===_?void 0:_.x1)||0),height:n,position:"absolute",borderRight:"1px solid ".concat(R.default.rect)}})]}),(0,o.jsx)("div",{onPointerEnter:f,onPointerMove:f,onPointerLeave:function(){v(-1)},style:{position:"absolute",top:"0px",left:"-".concat(5,"px"),width:"".concat(i+10,"px"),height:n+20,backgroundColor:"rgba(255,255,255, .01)"}}),(0,o.jsx)("div",{className:"mid-gray fw4 bg-white absolute",style:{pointerEvents:"none",height:"15px",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis"},children:_?null!==(M=_.label)&&void 0!==M?M:"NULL/EMPTY":"".concat(U(s)," ").concat(s>1?"categories":"category")})]})]})};var Z=n(3961),F=n(12447),T=n(72760),q=n(4242);class A extends Z.i{async process(e){return await e({type:"request_table_data",node_id:this._id,start:this._start,end:this._end})}constructor(e,t,n){super(),this._id=e,this._start=t,this._end=n}}const B="var(--border-radius-2)",W=V.memo((function(e){let{node:t}=e;const{id:n,pinned:r}=t;var i;const{generation:c,leftRadius:l,bottomRadius:d}=(0,q.v9)((e=>{let{notebook:{hoverId:t,focusId:o,workerStatus:s}}=e;var a,c;return{generation:null!==(i=null===(a=s.get(n))||void 0===a||null===(c=a.display)||void 0===c?void 0:c.generation)&&void 0!==i?i:-1,leftRadius:t===n||o===n?void 0:B,bottomRadius:o===n||r?void 0:B}})),{0:u,1:p}=(0,V.useState)(-1),b=(0,V.useRef)(null),{0:m,1:v}=(0,V.useState)(),f=(null===m||void 0===m?void 0:m.generation)===c?m.rows.length:0,{0:h,1:g}=(0,V.useState)(20),y=(0,V.useRef)(),k=(0,q.I0)();(0,V.useEffect)((()=>{if(f>=h)return;const e=new A(n,f,h);y.current=e,e.run(k).then((t=>{e===y.current&&v((e=>(null===e||void 0===e?void 0:e.generation)!==c?{generation:c,summaries:t.summaries,rows:t.rows,nRows:t.nRows}:{generation:c,summaries:e.summaries,rows:e.rows.concat(t.rows),nRows:e.nRows}))}),(t=>{e===y.current&&console.error("table data failed: ".concat(t))}))}),[n,k,c,f,h]),(0,V.useEffect)((()=>{var e;null===(e=b.current)||void 0===e||e.scrollTo(0,0),g(20)}),[t]);return(0,o.jsxs)("div",{className:"jsx-d8d34d8770ccd6c2 relative pea",children:[(0,o.jsx)("div",{ref:b,onScroll:e=>{let{currentTarget:t}=e;t.scrollHeight-t.scrollTop<492&&f>=h&&g(h+20)},style:{margin:"0 -14px",borderTopLeftRadius:l,borderTopRightRadius:B},className:"jsx-d8d34d8770ccd6c2 container overflow-auto bt bl br b--light-silver",children:(0,o.jsxs)("table",{className:"jsx-d8d34d8770ccd6c2 w-100 dark-gray ma0 nowrap overflow-visible",children:[m&&(0,o.jsx)(H,{node:t,dispatch:k,data:m,hoveredRow:u}),m&&(0,o.jsx)(Y,{data:m,setHoveredRow:p})]})}),(null===m||void 0===m?void 0:m.summaries)&&(0,o.jsxs)("div",{style:{margin:"0 -14px",borderBottomLeftRadius:l&&d,borderBottomRightRadius:d},className:"jsx-d8d34d8770ccd6c2 "+(a()("mid-gray f7 flex items-center justify-between b--light-silver pv1 ph2",m.nRows>0?"ba":"br bl bb")||""),children:[(0,o.jsx)("div",{className:"jsx-d8d34d8770ccd6c2",children:(0,T.u2)(t)}),(0,o.jsxs)("div",{className:"jsx-d8d34d8770ccd6c2",children:[m.nRows.toLocaleString(),1===m.nRows?" row":" rows"]})]}),(0,o.jsx)(s(),{id:"d8d34d8770ccd6c2",children:".container.jsx-d8d34d8770ccd6c2{max-height:369px}table.jsx-d8d34d8770ccd6c2{font:13px/1.2 var(--sans-serif);border-collapse:separate;border-spacing:0}"})]})})),H=e=>{let{node:t,data:n,hoveredRow:r,dispatch:i}=e;var a;const{id:l,data:d}=t,{0:u,1:p}=(0,V.useState)(-1);var b;const m="table"!==(null===(a=d.display)||void 0===a?void 0:a.mode)||(null===(b=d.display.showSummaries)||void 0===b||b);return(0,o.jsxs)("thead",{className:s().dynamic([["f060be80380ac27a",[F.hs]]])+" sticky top-0 v-top tl",children:[(0,o.jsxs)("tr",{className:s().dynamic([["f060be80380ac27a",[F.hs]]]),children:[(0,o.jsx)("th",{role:"button","data-cy":"cell-table-header-row",onClick:()=>{i({type:"setDisplay",id:l,display:{mode:"table",showSummaries:!m}})},className:s().dynamic([["f060be80380ac27a",[F.hs]]]),children:(0,o.jsx)(c.Z,{style:{transform:m?"":"rotate(-90deg)",transition:"transform 150ms ease"}})}),Array.from(n.summaries,((e,t)=>{let[i,a]=e;const c=m&&a.nRows>1,l=c?130:void 0,d=c?70:void 0,b=r in n.rows?n.rows[r][i]:N.V8;return(0,o.jsxs)("th",{onPointerEnter:()=>p(t),onPointerLeave:()=>p(-1),style:{minWidth:l,padding:5,height:d,zIndex:u===t?9999:1},className:s().dynamic([["f060be80380ac27a",[F.hs]]]),children:[(0,o.jsx)("div",{className:s().dynamic([["f060be80380ac27a",[F.hs]]])+" dark-gray",children:i}),c?"categorical"===a.summaryType?(0,o.jsx)(L,{data:a.data,isUnique:a.isUnique,height:30,width:l,numCategories:a.numCategories,type:a.type,typeLabel:a.type,hoveredValue:b}):(0,o.jsx)(C,{type:a.type,typeLabel:a.type,data:a.data,height:30,width:l,numMissing:a.numMissing,nRows:a.nRows,formatter:(0,N.QI)(a.type),hoveredValue:(0,N.kq)(b)}):(0,o.jsx)("div",{className:s().dynamic([["f060be80380ac27a",[F.hs]]])+" mid-gray fw4",children:a.type})]},t)}))]}),(0,o.jsx)(s(),{id:"f060be80380ac27a",dynamic:[F.hs],children:"th.__jsx-style-dynamic-selector{position:relative;background:var(--white);border-bottom:solid 1px var(--light-silver);border-left:solid 1px var(--light-silver);max-width:300px}th.__jsx-style-dynamic-selector:first-child{border-left:none;vertical-align:top;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:25px;padding:5px}@media ".concat(F.hs,"{th.__jsx-style-dynamic-selector{max-width:600px}}")})]})},Y=V.memo((function(e){let{data:t,setHoveredRow:n}=e;return(0,o.jsxs)("tbody",{className:"jsx-75b7a56becfd0ee9",children:[t.rows.map(((e,r)=>(0,o.jsxs)("tr",{"data-cy":"cell-table-result-row",onPointerEnter:()=>n(r),onPointerLeave:()=>n(-1),className:"jsx-75b7a56becfd0ee9",children:[(0,o.jsx)("td",{className:"jsx-75b7a56becfd0ee9",children:r}),Array.from(t.summaries,((t,n)=>{let[r,s]=t;const i=e[r],a=i instanceof Error?"<unavailable>":""===i?"<empty>":null==i?"null":"object"===s.type||"buffer"===s.type?i:(0,N.QI)(s.type)(i);return(0,o.jsx)("td",{title:a.length>40?a:void 0,className:"jsx-75b7a56becfd0ee9 "+((null===i||void 0===i||i instanceof Error||""===i?"gray fw4":s.type)||""),children:a},n)}))]},r))),(0,o.jsx)(s(),{id:"75b7a56becfd0ee9",children:"tbody.jsx-75b7a56becfd0ee9{max-height:300px;overflow-y:scroll}td.jsx-75b7a56becfd0ee9{padding:4px 6px;border-top:solid 1px var(--light-silver);border-left:solid 1px var(--light-silver);white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}tr.jsx-75b7a56becfd0ee9:hover{background-color:var(--near-white)}tr.jsx-75b7a56becfd0ee9:first-child td.jsx-75b7a56becfd0ee9{border-top:none}td.jsx-75b7a56becfd0ee9:first-child{border-left:none}td.jsx-75b7a56becfd0ee9:nth-child(1){text-align:center;color:var(--moon-gray);padding:0 4px}.number.jsx-75b7a56becfd0ee9,.integer.jsx-75b7a56becfd0ee9,.bigint.jsx-75b7a56becfd0ee9{text-align:right}.number.jsx-75b7a56becfd0ee9,.integer.jsx-75b7a56becfd0ee9,.bigint.jsx-75b7a56becfd0ee9,.date.jsx-75b7a56becfd0ee9{font-variable-numeric:tabular-nums}"})]})}))},84269:function(e,t,n){n.d(t,{Z:function(){return D}});var o=n(41799),r=n(85893),s=n(91594),i=n(64063),a=n.n(i),c=n(602),l=n(74080),d=n(48873),u=n(86500),p=n(50826),b=n(5969),m=n(33042),v=n(5315),f=n(31343),h=n(69150),g=n(88725),y=n(66421),k=n(928),x=n(3142),w=n(58671),R=n(11163),S=n.n(R),U=n(67294);function _(e){return M(e.input)&&M(e.stack)&&M(e.message)&&M(e.name)}function M(e){return void 0===e||"string"===typeof e}var j=n(4778),V=n(9580);const C=new Map;let E=0;function P(e){return new Map(e.filter((e=>"notebook"===e.type)).map((e=>[e.specifier,e.value])))}function D(e){let{state:t,currentUser:n,dispatch:i,initialWorkerEvents:a}=e;const{owner:R,model:M,files:D,heights:I,workerTasks:N}=t,L=(0,x.DF)(t),Z=(0,x.cE)(t),F=(0,U.useRef)(),T=(0,U.useRef)(),q=(0,U.useRef)(),A=(0,U.useRef)(),B=(0,U.useRef)(),W=(0,U.useRef)(),H=(0,U.useRef)(M.nodes[0]),Y=(0,U.useRef)(),z=(0,U.useRef)(),G=(0,U.useRef)(),X=(0,U.useRef)(),J=(0,U.useRef)(),$=(0,U.useRef)(),Q=(0,U.useRef)(),K=(0,U.useRef)(new Map),ee=(0,U.useRef)(),te=(0,U.useRef)(),ne=(0,U.useRef)(t.saveVersion),oe=(0,U.useRef)(),re=(0,U.useRef)(P(M.resolutions)),se=(0,U.useRef)(new Map);function ie(e,t,n){let o,r;void 0===t&&void 0===n?(o=!1,r=new Promise(((e,o)=>{t=e,n=o}))):o=!0;const s=++E;return e.id=s,C.set(s,[t,n,o]),q.current(e),r}function ae(e){const{pathname:t,search:n,hash:o}=location;$.current===t&&Q.current===o||($.current=t,Q.current=o,e.push({type:"navigate",pathname:t,search:n,hash:o}))}function ce(){return Math.min(ne.current,te.current)}function le(){return"".concat(t.id,"@").concat(ce())}function de(e){return e.toModuleURL(le())}function ue(e){return re.current.has("".concat(e))}function pe(){return!((0,l.QY)(t)&&(0,y.mG)(t))||ee.current>=ce()}function be(e){return!Z||void 0!==e.login&&e.login!==R.login}async function me(e,t,n,o){const r={id:t,specifier:"".concat(n)};if(K.current.set(e,r),o&&!ue(n)){const t=await async function(e){try{const{specifiers:t}=await(0,c.a8)("/document/".concat(e,"/imports?resolutions=").concat(le(),"&importer=").concat(Z?R.login:"anonymous"),{signal:J.current});return Object.entries(t).filter((e=>{let[,{owner:t}]=e;return t!==R.login})).map((e=>{let[t,{resolution:n}]=e;return{type:"notebook",specifier:t,value:n}}))}catch(t){if(404===t.status)return[];throw t}}(n);if(K.current.get(e)!==r)return;t.length&&function(e){for(const{specifier:t,value:n}of e)se.current.set(t,n);i({type:"resolveDependencies",resolutions:e,trigger:"implicit",source:"cellEvaluation"})}(t)}if(be(n))return r.module=de(n),void he();r.needsToBeSigned=!0,ve(),he()}function ve(){if(pe())for(const[,e]of K.current)e.needsToBeSigned&&(e.needsToBeSigned=!1,fe(e))}async function fe(e){try{const{import_path:o,owner:r,secrets:s,database_clients:i}=await(t=e.specifier,n={signal:J.current},(0,c.a8)("/document/".concat(t,"/import").concat("?resolutions=".concat(le())),n));r.id===R.id?(e.module="".concat("https://api.observablehq.com").concat(o),s&&await ge(s),i&&ke(i)):e.module=de(k.Z.parse(e.specifier))}catch(o){if("AbortError"===o.name)return;e.error=o instanceof f.ZP&&404===o.status?"Notebook '".concat(e.specifier,"' not found"):o.message}var t,n;he()}function he(){if(!pe())return;const e=q.current;for(const[t,n]of K.current){const{id:o,specifier:r,module:s,error:i}=n;i?(e({type:"resolve_import",id:o,specifier:r,error:i}),K.current.delete(t)):"string"===typeof s&&(e({type:"resolve_import",id:o,specifier:r,module:s}),K.current.delete(t))}}async function ge(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!Z)return;if(!e.length)return void(void 0===z.current&&(z.current=null,t.unshift({type:"reset_secret",delay:!1})));z.current||(z.current=ye());const n=q.current,o=Y.current,r=z.current;let s;e.some((e=>!o.has(e)))&&(t.unshift({type:"reset_secret",delay:!0}),s=!0);const i=await r,a=[];for(const c of e)o.has(c)||(o.add(c),i.has(c)&&a.push([c,i.get(c)]));(a.length||s)&&n({type:"resolve_secrets",secrets:a})}async function ye(){let e;if("team"===R.type)e=await(0,c.a8)("/team/".concat(R.id,"/secrets"));else if(e=await(0,c.a8)("/user/secrets"),R.id!==n.id)throw new Error("access denied");return new Map(e.map((e=>{let{name:t,value:n}=e;return[t,n]})))}function ke(e){if(Z)for(const t of e)G.current.add(t)}ee.current=t.saveVersion,te.current=M.version,(0,U.useEffect)((()=>{oe.current=M.resolutions,re.current=P(M.resolutions)}),[M.resolutions]),(0,U.useEffect)((()=>{function e(){const e=[];ae(e),e.length&&q.current({type:"bundle",events:e})}return addEventListener("hashchange",e),()=>removeEventListener("hashchange",e)}),[]),(0,U.useEffect)((()=>{function e(){q.current({type:"blur"})}function t(){var e;document.activeElement===T.current&&(i({type:"selectionClear"}),null===(e=window.getSelection())||void 0===e||e.removeAllRanges())}return t(),addEventListener("focus",e),addEventListener("blur",t),()=>{removeEventListener("focus",e),removeEventListener("blur",t)}}),[i]);const xe=(0,p.y)(n,t,"current_user_emails");(0,U.useEffect)((()=>{if(n&&L){const{login:e,name:t,bio:r,home_url:s,avatar_url:i,identities:a}=n;X.current=(0,o.Z)({login:e,name:t,bio:r,url:s,avatar:i},xe&&{email:a.concat(n).map((e=>e.email)).find((e=>!!e))})}else X.current=void 0}),[L,xe,n]),(0,U.useEffect)((()=>{const e=(0,g.vE)(R),t=new AbortController;let n=[];(null===a||void 0===a?void 0:a.length)&&n.push({type:"bundle",events:a});const o=document.createElement("iframe");o.style.width="calc(100% + ".concat(2*h.Mv,"px)"),o.style.margin="0 ".concat(-h.Mv,"px"),o.style.border="none",o.scrolling="no",o.sandbox=g.Ar,o.allow=g.sq,o.src="".concat(e,"/next/").concat(j.xF),addEventListener("message",s),F.current.appendChild(o);const r=o.contentWindow;function s(t){if(!t.isTrusted||t.origin!==e||t.source!==r)return;const s=t.data;if(void 0!==s.id){const{id:e}=s,t=C.get(e);if(t){const[n,o,r]=t,{error:i}=s;return void(r?((void 0!==i||s.done)&&C.delete(e),void 0!==i?o(i):n(s)):(C.delete(e),void 0!==i?o(i):n(s.value)))}}else switch(s.type){case"hello":return void function(){if(!n)return;for(const t of n)r.postMessage(t,e);n=null}();case"resize":return void function(e){let{node_id:t,height:n}=e;(0,v.qX)(i,(e=>{let{heights:o}=e;return o.push({type:"worker",id:+t,height:+n})}))}(s);case"hover":return void function(e){let{node_id:t}=e;i({type:"hover",id:+t})}(s);case"errors":return void function(e){let{errors:t}=e;if(!(t instanceof Map))return;for(const[n,o]of t)if("number"!==typeof n||null!==o&&!_(o))return;i({type:"workerErrors",errors:t})}(s);case"navigate":return void function(e){let{pathname:t,search:n,hash:o}=e;const r="".concat(t).concat(n).concat(o);S().push(r)}(s);case"display":return void function(e){let{node_id:t,mode:n}=e;(0,u.I)(i,(e=>{let{displays:o}=e;return o.set(+t,{mode:"".concat(n)})}))}(s);case"pending":case"fulfilled":case"rejected":return void function(e){let{type:t,node_id:n}=e;(0,u.I)(i,(e=>{let{statuses:o}=e;return o.set(+n,"".concat(t))}))}(s);case"request_database_token":return void async function(e){const t=q.current;if(!Z)return void t({type:"resolve_database_token",name:e,error:V.uW});if(!G.current.has(e))return void t({type:"resolve_database_token",name:e,error:"Database not allowed"});let n;try{n=await(0,c.Fv)("".concat("team"===R.type?"/team/".concat(R.id):"/user","/data-connector/token"),{name:e})}catch(o){return void t({type:"resolve_database_token",name:e,error:"Database not found"})}t({type:"resolve_database_token",name:e,token:n})}(s.name);case"request_cloud_file":return void async function(e){const t=q.current;if(!Z)return void t({type:"resolve_cloud_file",name:e,error:V.Px});const n=oe.current.find((t=>"cloud_file"===t.type&&t.specifier===e));if(!n)return void t({type:"remove_file",name:e});try{const o=await(0,d.w)(R,n);t({type:"resolve_cloud_file",name:e,url:o})}catch(o){t({type:"resolve_cloud_file",name:e,error:o.message})}}(s.name);case"current_user":return void async function(){const e=q.current;await e({type:"current_user",currentUser:X.current})}();case"escape":return void(document.activeElement===o&&(window.focus(),i({type:"blur"})))}}return T.current=o,q.current=t=>{n?n.push(t):r.postMessage(t,e)},A.current=-1,B.current=new Map,W.current=new Map,Y.current=new Set,G.current=new Set,J.current=t.signal,()=>{i({type:"workerGoodbye"}),removeEventListener("message",s),q.current=void 0,A.current=void 0,B.current=void 0,W.current=void 0,Y.current=void 0,z.current=void 0,G.current=void 0,J.current=void 0,$.current=void 0,Q.current=void 0,T.current=void 0,o.remove(),o.src="about:blank",t.abort()}}),[L,Z,R,i,a]);const we=M.nodes.length;return(0,U.useEffect)((()=>{if(!T.current)return;const e=(0,v.hY)(I)+(we+1)*h.KI;T.current.style.height="".concat(e,"px")}),[we,I]),(0,U.useEffect)((()=>{const e=[],n=[],o=[],r=[];if(function(e,t,n,o,r,i,a,c,l){const d=e.current<0?s.Z.create(t).events.filter((e=>e)):t.history.slice(e.current),u=new Set;let p=!1;for(const s of d){const{type:d}=s;switch(d){case"modify_data":if(O(s)){const{node_id:e,new_node_data:t}=s;n.push({type:"modify_display",node_id:e,new_node_data:t});continue}case"mode_node":case"insert_node":case"modify_node":case"modify_name":{const{node_id:a,new_next_node_id:c,new_node_mode:p,new_node_data:b}=s,v=(0,w.Z)((0,m.DY)(t,a)||{value:"",mode:"js",name:null}),f={type:d,node_id:a,new_node_value:v,new_next_node_id:c,new_node_mode:p,new_node_data:b};"import"===v.type?o.push({nodeId:a,value:v,shouldCapture:e.current>=0&&s.version>l}):(v.secrets&&r.push(...v.secrets),v.databaseClients&&i.push(...v.databaseClients)),u.add(a),n.push(f);break}case"move_node":{const{node_id:e,new_next_node_id:t}=s;n.push({type:d,node_id:e,new_next_node_id:t});break}case"remove_node":{const{node_id:e}=s;n.push({type:d,node_id:e});break}case"resolve_dependency":{const{version:e,specifier:t,specifier_type:o,new_resolution:r}=s;if("cloud_file"===o)r?n.push({type:"insert_file",name:t,cloud:!0}):n.push({type:"remove_file",name:t});else if("notebook"===o){const n=c.get(t);n&&n===r?c.delete(t):a.current<e&&(p=!0,a.current=e)}break}}}p&&function(e,t,n,o){for(const r of e.nodes){if(t.has(r.id))continue;t.add(r.id);const s=(0,w.Z)((0,m.DY)(e,r.id)||{value:"",mode:"js",name:null});"import"===s.type&&(n.push({nodeId:r.id,value:s,shouldCapture:!1}),o.push({type:"modify_node",node_id:r.id,new_node_value:s}))}}(t,u,o,n);e.current=t.history.length}(A,M,e,n,o,r,ne,se.current,t.saveVersion),function(e,t,n){if(e.current!==t){const o=e.current;e.current=t;for(const[e,r]of t){const t=o.get(e);if((0,b.ki)(r))if((0,b.ki)(t)){if("pending"===t.status&&void 0===t.blob&&"pending"!==r.status){const{url:t,mimeType:o}=r;n.push({type:"modify_file",name:e,url:t,mimeType:o})}else if("pending"===t.status&&t.blob&&"pending"!==r.status&&t.mimeType!==r.mimeType){const{blob:t,mimeType:o}=r;n.push({type:"modify_file",name:e,blob:t,mimeType:o})}}else{const{url:t,blob:o,mimeType:s}=r;n.push({type:"insert_file",name:e,url:t,blob:o,mimeType:s})}}for(const[e,r]of o){const o=t.get(e);!(0,b.ki)(o)&&(0,b.ki)(r)&&n.push({type:"remove_file",name:e})}}}(B,D,e),function(e,t,n){if(e.current!==t){const o=e.current;e.current=t;for(const[e,{editor:r,comments:s,display:i}]of t){const t=r+s+i;(o.has(e)?o.get(e).editor+o.get(e).comments+o.get(e).display:0)!==t&&n.push({type:"offset_node",node_id:e,height:t})}for(const[e,{editor:r}]of o)t.has(e)||0===r||n.push({type:"offset_node",node_id:e,height:0})}if(n.length){const e=new Map;for(const{type:o,node_id:r}of n)switch(o){case"insert_node":{const n=t.get(r);n&&e.set(r,n.editor+n.comments+n.display);break}case"remove_node":e.delete(r)}for(const[t,o]of e)n.push({type:"offset_node",node_id:t,height:o})}}(W,I,e),function(e){for(const{nodeId:t,value:n,shouldCapture:o}of e){const e=k.Z.parse(n.specifier);null===e?n.module=n.specifier:(n.notebook=e.toNotebookURL(),be(e)&&(!o||ue(e))&&pe()?n.module=de(e):(n.module=++E,me(t,n.module,e,o)))}}(n),ge(o,e),ke(r),ae(e),e.length&&q.current({type:"bundle",events:e}),function(e,t,n){const o=t.nodes[0];if(o!==e.current||n.some((e=>{let{type:t,node_id:n}=e;return"modify_node"===t&&n===o.id})))return e.current=o,!0;return!1}(H,M,e)){(M.version>t.initialLatestVersion||M.version>t.saveVersion)&&async function(){const e=M.nodes[0].id,t=await ie({type:"extract_title",node_id:e});i({type:"title",value:"".concat(t).slice(0,255)})}()}!function(e){if(e.size)for(const t of[...e])e.delete(t),t.resolve(t.process(ie))}(N),ve(),he()})),(0,r.jsx)("div",{ref:F})}function O(e){const{type:t,old_node_data:n,new_node_data:o}=e;return"modify_data"===t&&!a()(null===n||void 0===n?void 0:n.display,null===o||void 0===o?void 0:o.display)}},48873:function(e,t,n){n.d(t,{a:function(){return a},w:function(){return c}});var o=n(92876),r=n(9580),s=n(602),i=n(4598);function a(e){const t=/^([a-zA-Z]+):\/\/(.*)$/.exec(e.specifier);if(!t)return null;const n=Object.entries(i.c).find((e=>{let[,{shorthand:n}]=e;return n===t[1]}));return n?{provider:n[0],name:t[2],specifier:e.specifier,path:e.value}:null}async function c(e,t){const n=a(t);if(!n)throw(0,o.uT)("Invalid cloud file path: ".concat(t.value)),new Error("Invalid cloud file path.");return async function(e,t){let n;try{const o="team"===e.type?"/team/".concat(e.id):"/user";n=await(0,s.Fv)("".concat(o,"/cloud-file/token"),{provider:t.provider,path:t.path})}catch(o){throw new Error(r.t5)}return"".concat("https://connector.observableusercontent.com","/file?token=").concat(encodeURIComponent(n))}(e,n)}},87099:function(e,t,n){function o(e,t){const n=URL.createObjectURL(e);r(n,t),URL.revokeObjectURL(n)}function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=document.createElement("a");n.style.display="none",n.href=e,n.download=t,document.body.appendChild(n),n.click(),n.remove()}n.d(t,{G:function(){return r},L:function(){return o}})},5315:function(e,t,n){function o(e){let t=0;for(const{total:n}of e.values())t+=n;return t}function r(e,t,n,o){let r=0;const i=new ResizeObserver((e=>{let[i]=e;const a=i.contentRect.height;a!==r&&(r=a,s(o,(e=>{let{heights:o}=e;return o.push({type:n,id:t,height:r})})))}));return i.observe(e),{disconnect(){i.disconnect(),0!==r&&(r=0,s(o,(e=>{let{heights:o}=e;return o.push({type:n,id:t,height:r})})))}}}n.d(t,{hY:function(){return o},jn:function(){return r},qX:function(){return s}});const s=(0,n(22225).J)((()=>({type:"cellHeight",heights:[]})))},8802:function(e,t,n){n.d(t,{Z:function(){return s}});let o=0;const r=new WeakMap;function s(e){let t=r.get(e);return void 0===t&&r.set(e,t=o++),t}},98957:function(e,t,n){n.d(t,{O:function(){return s}});var o=n(11163),r=n.n(o);const s=(e,t)=>{let{base:n,target:o}=t;const s="".concat(n.id).concat(n.version?"@".concat(n.version):""),i="".concat(o.id).concat(o.version?"@".concat(o.version):"");r().push("/compare/".concat(s,"...").concat(i))}},59201:function(e,t,n){n.d(t,{Ez:function(){return a},GJ:function(){return p},Ge:function(){return l},Gr:function(){return v},LZ:function(){return m},P4:function(){return d},Yd:function(){return u},_O:function(){return b},lx:function(){return i},rE:function(){return c},y3:function(){return s}});var o=n(41799),r=n(602);const s=new Set(["gettingStarted","loadingData","exploringData","reusingCode","collaborating","troubleshooting","links","keyboardShortcuts"]);const i=(e,t)=>{let{pane:n,focusKeyboardShortcuts:r}=t;return e.pane===n?e.guide&&"guide"!==n?{pane:"guide"}:{pane:null}:(0,o.Z)({pane:n},r&&{helpArticlesOpen:[],helpPaneSectionsOpen:new Set(["keyboardShortcuts"])})},a=(e,t,n)=>{let{page:o,decorations:{signpost:r}}=e,{pane:s}=t;o.pane!==s&&r&&r===function(e){return"help"===e?"help":null}(s)&&n({type:"dismissSignpost",trigger:"Implicit"})},c=e=>e.guide&&"guide"!==e.pane?{pane:"guide"}:{pane:null},l=async(e,t,n)=>{let{notebook:o}=e,{collection:s}=t,{initialCollection:i}=o;(null===i||void 0===i?void 0:i.id)!==s.id&&(i=await(0,r.a8)("/collection/@".concat(s.owner.login,"/").concat(s.slug))),n({type:"openCollectionsSidebar",collection:i})},d=e=>({collectionsSidebarOpen:!e.collectionsSidebarOpen}),u=(e,t)=>({collectionsSidebarOpen:!t.orphaned&&e.collectionsSidebarOpen}),p=(e,t)=>{let{helpPaneSectionsOpen:n}=e,{section:o}=t;return n=new Set(n),n.has(o)?n.delete(o):n.add(o),{helpPaneSectionsOpen:n}},b=()=>({collectionsSidebarOpen:!0}),m=(e,t)=>{let{helpArticlesOpen:n}=e,{article:o,reset:r}=t;return{helpArticlesOpen:r?[o]:n.concat(o)}},v=e=>{let{helpArticlesOpen:t}=e;return{helpArticlesOpen:t.slice(0,-1)}}},33199:function(e,t,n){n.d(t,{C:function(){return D}});var o=n(30169),r=n(19671),s=n(33042);const i=(e,t)=>{let{notebook:n,currentUser:o}=e,{type:s,id:i,trigger:a,source:c}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:manage:insert",data:{cellIds:[i],trigger:a,source:c,before:"insertBefore"===s},eventVersion:3,notebook:n,currentUser:o}))},a=(e,t)=>{let{notebook:n,currentUser:o}=e,{id:s}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:manage:move",data:{cellIds:[s]},eventVersion:3,notebook:n,currentUser:o}))},c=(e,t)=>{let{notebook:n,currentUser:o}=e,{type:i,id:a,trigger:c}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:manage:split",data:{cellIds:[a],mode:(0,s.DY)(n.model,a).mode,trigger:c,source:"nodeEditor",before:"splitBefore"===i},eventVersion:1,notebook:n,currentUser:o}))};function l(e,t){return e.length>t?"".concat(e.slice(0,t-1),"\u2026"):e}var d=n(88725);var u=n(19170);var p=n(24205);function b(e,t,n,o){switch(e){case"help":(0,r.MR)((0,r.ym)({type:"notebook:view:helpPaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:o}));break;case"files":(0,r.MR)((0,r.ym)({type:"notebook:view:filesPaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:o}));break;case"history":(0,r.MR)((0,r.ym)({type:"notebook:view:historyPaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:o}));break;case"minimap":(0,r.MR)((0,r.ym)({type:"notebook:view:minimapPaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:o}));break;case"insights":(0,r.MR)((0,r.ym)({type:"notebook:view:insightsPaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:o}));break;case"find":(0,r.MR)((0,r.ym)({type:"notebook:view:findPaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:o}));break;case"dependencies":(0,r.MR)((0,r.ym)({type:"notebook:view:dependenciesPaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:o}));break;case"guide":(0,r.MR)((0,r.ym)({type:"notebook:view:guidePaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:o}));break;case"databases":(0,r.MR)((0,r.ym)({type:"notebook:view:databasesPaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:o}));break;default:m(e)}}function m(e){throw new Error("Panes analytics - unexpected pane type: ".concat(e))}var v=n(21571),f=n(6025),h=n(60066),g=n(6022),y=n(98957),k=n(47977),x=n(87099);var w=n(81931),R=n(17152),S=n(3729),U=n(91398),_=n(59201),M=n(51133),j=n(38559),V=n(99223),C=n(99494),E=n(3361),P=n(8740);const D={acceptCompletion:(e,t)=>{let{notebook:n,currentUser:o}=e,{origin:s}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:manage:acceptCompletion",data:{origin:s},eventVersion:1,notebook:n,currentUser:o}))},acceptSnippet:C.eY,acknowledgeSuggestionClosed:P.G6,addedDatabase:(e,t)=>{let{notebook:n,currentUser:o}=e,{id:s}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:manage:addDatabase",data:{cellIds:[s]},eventVersion:1,notebook:n,currentUser:o}))},closeSuggestion:P.nK,closeSuggestionSucceeded:p.JB,cloudFileSnippet:k.zX,commentComposeCancel:(e,t)=>{let{notebook:n,currentUser:o}=e,{nodeId:s,trigger:i,content:a,source:c}=t;var l;(0,r.MR)((0,r.ym)({type:"notebook:cells:comment:cancel",data:{cellIds:[s],length:a.length,trigger:i,source:c},eventVersion:4,notebook:n,currentUser:o})),n.comments.has(s)&&0!==(null===(l=n.comments.get(s))||void 0===l?void 0:l.length)||(0,r.MR)((0,r.ym)({type:"notebook:cells:comment:hideComments",data:{cellIds:[s],cancelCompose:!0,trigger:i,source:"commentBox"},eventVersion:2,notebook:n,currentUser:o}))},commentComposeOpen:(e,t)=>{let{notebook:n,currentUser:o}=e,{nodeId:s,trigger:i,source:a}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:comment:openCompose",data:{cellIds:[s],trigger:i,source:a},eventVersion:3,notebook:n,currentUser:o}))},commentCreated:(e,t)=>{let{notebook:n,currentUser:o}=e,{nodeId:s,source:i}=t;const a=(0,d.o7)(n,s),c=(0,d.HS)(n,s),l=new Set;for(const r of c)l.add(r.user.id);for(const r of a)l.add(r.user.id);const u=c.some((e=>e.user.id===(null===o||void 0===o?void 0:o.id)))||a.some((e=>e.user.id===(null===o||void 0===o?void 0:o.id)));(0,r.MR)((0,r.ym)({type:"notebook:cells:comment:submit",data:{cellIds:[s],commentsOnCell:c.length+a.length,unresolvedCommentsOnCell:c.length,commentersOnCell:l.size,userHasCommentedOnCell:u,trigger:"click",source:i},eventVersion:4,notebook:n,currentUser:o}))},commentDeleted:(e,t)=>{let{notebook:n,currentUser:o}=e,{comment:s,trigger:i,source:a}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:comment:delete",data:{cellIds:[s.node_id],userIsCommentAuthor:s.user.id===(null===o||void 0===o?void 0:o.id),trigger:i,source:a},eventVersion:3,notebook:n,currentUser:o}))},commit:(e,t)=>{let{notebook:n,currentUser:o}=e,{id:s,trigger:i,source:a}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:edit:evaluate",data:{cellIds:[s],trigger:i,source:a},eventVersion:6,notebook:n,currentUser:o})),ga("send","event","Notebook","Edit")},copyDatabaseCode:k.ZG,copyFileCode:[w.Nz,p.Hf],disableAutosave:e=>{let{notebook:t,currentUser:n}=e;(0,r.MR)((0,r.ym)({type:"notebook:view:autosaveDisabled",eventVersion:1,notebook:t,currentUser:n}))},dismissPane:e=>{let{notebook:t,page:n,currentUser:o}=e;null!==n.pane&&b(n.pane,null,t,o)},dismissWelcomeMatBanner:()=>{(0,r.MR)((0,r.a$)({type:"marketing:view:dismissWelcomeBanner",data:{experiment:null},eventVersion:1,currentUser:null}))},dragEnded:a,downloadCode:[async e=>{let{notebook:t}=e;const{id:n,saveVersion:o}=t,r=await fetch("".concat("https://api.observablehq.com","/document/").concat(n,"@").concat(o,"/download?v=3"),{credentials:"include"}),{tarball_path:s}=await r.json();(0,x.G)("".concat("https://api.observablehq.com").concat(s))},p.kg],downloadCloudFile:k.Tv,downloadFile:p.lA,exitVersionedMode:f.Q,fileMarkedForDeletion:p.hO,replaceFile:w.bC,fileReplaced:p.tq,focusDefinition:(e,t)=>{let{notebook:n,currentUser:o}=e,{id:s,trigger:i,source:a}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:view:focusDefinition",data:{cellIds:[s],trigger:i,source:a},eventVersion:1,notebook:n,currentUser:o}))},focusError:(e,t)=>{let{notebook:n,currentUser:o}=e,{id:s}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:view:focusError",data:{cellIds:[s]},eventVersion:1,notebook:n,currentUser:o}))},forkRequested:R.J1,embedModalCopy:p.M6,helpPaneLinkClicked:(e,t)=>{let{notebook:n,currentUser:o}=e,{section:s,url:i}=t;(0,r.MR)((0,r.ym)({type:"notebook:view:helpPaneLink",data:{section:s,url:i},eventVersion:1,notebook:n,currentUser:o}))},hideComments:(e,t)=>{let{notebook:n,currentUser:o}=e,{nodeId:s,trigger:i,source:a}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:comment:hideComments",data:{cellIds:[s],cancelCompose:!1,trigger:i,source:a},eventVersion:2,notebook:n,currentUser:o}))},insertAfter:i,insertBefore:i,insertCloudFile:k.Xm,insertDatabase:k._E,insertFile:p.Nl,insertSnippet:C.ns,like:U.v,liked:(e,t)=>{let{notebook:n,currentUser:o}=e,{liked:s}=t;(0,r.MR)((0,r.ym)({type:s?"notebook:social:like":"notebook:social:unlike",data:{},eventVersion:4,notebook:n,currentUser:o})),ga("send","event","Social","Like")},loadCompare:[y.O,(e,t)=>{let n,{notebook:o,currentUser:s}=e,{trigger:i,source:a,base:c,target:l,loadType:d}=t;if("reverse"!==d){switch(d){case"fork":n="notebook:view:compareFork";break;case"latest":n="notebook:view:compareLatest";break;case"published":n="notebook:view:comparePublished"}(0,r.MR)((0,r.ym)({type:n,data:{base:(0,r.tb)(c,s),target:(0,r.tb)(l,s),trigger:i,source:a},eventVersion:1,notebook:o,currentUser:s}))}}],loadVersion:S.n,loadedVersion:(e,t)=>{let{notebook:n,currentUser:o}=e,{body:s}=t;(0,r.MR)((0,r.ym)({type:"notebook:view:historyNavigate",data:{loadedVersion:s.version,navigationType:"version"},eventVersion:5,notebook:n,currentUser:o}))},attachLocalFiles:w.Mq,localFilesAttached:p.fe,moveDown:a,moveUp:a,notebookFilePickerOpened:p.Bv,openHelpArticle:(e,t)=>{let{notebook:n,currentUser:o}=e,{article:s}=t;(0,r.MR)((0,r.ym)({type:"notebook:view:helpArticleOpened",data:{article:s},eventVersion:1,notebook:n,currentUser:o}))},closeInsertMenu:(e,t)=>{let{notebook:n,currentUser:o}=e,{trigger:s,filter:i,selectedItem:a}=t;void 0!==a&&(a=l(a,50)),(0,r.MR)((0,r.ym)({type:"notebook:view:nodeInserterMenuClosed",data:{trigger:s,filter:l(i,50),selectedItem:a},eventVersion:1,notebook:n,currentUser:o})),ga("send","event","Notebook","Node inserter menu",a)},openInsertMenu:(e,t)=>{let{notebook:n,currentUser:o}=e,{before:s,trigger:i,source:a}=t;(0,r.MR)((0,r.ym)({type:"notebook:view:nodeInserterMenuOpened",data:{trigger:i,source:a,before:s},eventVersion:1,notebook:n,currentUser:o}))},relicense:p.mB,remove:(e,t)=>{let{notebook:n,currentUser:o}=e,{id:s}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:manage:delete",data:{cellIds:[s],includesLastCell:1===n.model.nodes.length},eventVersion:4,notebook:n,currentUser:o}))},requestSnippets:C.d1,removeCloudFile:k.kc,resolveComments:(e,t)=>{let{notebook:n,currentUser:o}=e,{nodeId:s,trigger:i,source:a}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:comment:resolve",data:{cellIds:[s],commentCount:(0,d.HS)(n,s).length,trigger:i,source:a},eventVersion:3,notebook:n,currentUser:o}))},revertRequested:M._$,replaceCurrent:(e,t)=>{let{notebook:n,currentUser:o}=e,{trigger:s,source:i}=t;const{caseSensitiveSearch:a,wholeWordSearch:c,regexSearch:l}=n;(0,r.MR)((0,r.ym)({type:"notebook:edit:replaceCurrent",data:{numSearchResults:(0,u.n)(n.searchResults),caseSensitiveSearch:a,wholeWordSearch:c,regexSearch:l,trigger:s,source:i},eventVersion:1,notebook:n,currentUser:o}))},replaceAll:[j.Rt,(e,t)=>{let{notebook:n,currentUser:o}=e,{trigger:s,source:i}=t;const{caseSensitiveSearch:a,wholeWordSearch:c,regexSearch:l}=n;(0,r.MR)((0,r.ym)({type:"notebook:edit:replaceAll",data:{numSearchResults:(0,u.n)(n.searchResults),caseSensitiveSearch:a,wholeWordSearch:c,regexSearch:l,trigger:s,source:i},eventVersion:1,notebook:n,currentUser:o}))}],reportAbuse:g.e5,selectionCut:V.S2,selectionCopy:V.S2,selectionInsert:(e,t)=>{let{notebook:n,currentUser:o}=e,{trigger:i,before:a=!1,inherit:c=!1}=t;const{selectionFocusId:l}=n;null!==l&&(0,r.MR)(c?(0,r.ym)({type:"notebook:cells:manage:split",data:{cellIds:[l],mode:(0,s.DY)(n.model,l).mode,trigger:i,source:"nodeSelection",before:a},eventVersion:1,notebook:n,currentUser:o}):(0,r.ym)({type:"notebook:cells:manage:insert",data:{cellIds:[l],trigger:i,source:"nodeSelection",before:a},eventVersion:3,notebook:n,currentUser:o}))},sendSuggestion:P.gd,sendSuggestionFailed:p.Hh,sendSuggestionSucceeded:p.yy,setAuthorAcceptance:v.jp,setAuthors:v.Yx,setMode:(e,t)=>{let{notebook:n,currentUser:o}=e,{id:s,source:i,trigger:a,mode:c}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:manage:setMode",data:{cellIds:[s],source:i,trigger:a,mode:c},eventVersion:1,notebook:n,currentUser:o}))},setDataSource:(e,t)=>{let{notebook:n,currentUser:o}=e,{id:s,source:i}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:manage:setDataSource",data:{cellIds:[s],source:i.type},eventVersion:1,notebook:n,currentUser:o}))},setDataOperations:(e,t)=>{let{notebook:n,currentUser:o}=e,{id:s,operations:i}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:manage:setDataOperations",data:{cellIds:[s],operations:Object.keys(i)},eventVersion:2,notebook:n,currentUser:o}))},setName:(e,t)=>{let{notebook:n,currentUser:o}=e,{id:i,source:a}=t;const{mode:c}=(0,s.DY)(n.model,i);(0,r.MR)((0,r.ym)({type:"notebook:cells:manage:setName",data:{cellIds:[i],source:a,trigger:"keypress",mode:c},eventVersion:1,notebook:n,currentUser:o}))},setOpenCollection:[_.Ge,e=>{let{notebook:t,currentUser:n}=e;(0,r.MR)((0,r.ym)({type:"notebook:view:changeCurrentCollection",data:{trigger:"click",source:"collectionsSidebar"},eventVersion:1,notebook:t,currentUser:n}))}],showModal:[o.k,(e,t)=>{let{currentUser:n,notebook:o}=e;switch(t.modal){case"license":(0,r.MR)((0,r.ym)({type:"notebook:view:licenseModal",data:{},eventVersion:2,notebook:o,currentUser:n}));break;case"addDatabase":(0,r.MR)((0,r.ym)({type:"notebook:view:addDatabaseModal",data:{},eventVersion:1,notebook:o,currentUser:n}));break;case"addCloudFile":(0,r.MR)((0,r.ym)({type:"notebook:view:cloudProviderModal",data:{},eventVersion:1,notebook:o,currentUser:n}));break;case"cloudFile":{const{provider:e}=t.modalProps;(0,r.MR)((0,r.ym)({type:"notebook:view:cloudFileModal",data:{provider:e},eventVersion:1,notebook:o,currentUser:n}));break}case"replaceFile":(0,r.MR)((0,r.ym)({type:"notebook:view:replaceFileModal",data:{},eventVersion:1,notebook:o,currentUser:n}));break;case"embed":(0,r.MR)((0,r.ym)({type:"notebook:manage:embedModalOpen",data:{trigger:"click",source:t.source},eventVersion:3,notebook:o,currentUser:n}))}}],showComments:(e,t)=>{let{notebook:n,currentUser:o}=e,{nodeId:s,trigger:i,source:a}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:comment:showComments",data:{cellIds:[s],trigger:i,source:a},eventVersion:2,notebook:n,currentUser:o}))},showFindPane:j.zI,splitBefore:c,splitAfter:c,dismissSuggestionOpenBanner:e=>{let{notebook:t,currentUser:n}=e;(0,r.MR)((0,r.ym)({type:"notebook:view:suggestionOpenBannerDismissed",data:{base:(0,r.tb)(t.forkOf,n),target:(0,r.tb)(t,n)},eventVersion:1,notebook:t,currentUser:n}))},resolveDependencies:p.hX,showNotebookDependencyDetails:p.dX,signatureHelp:(e,t)=>{let{notebook:n,currentUser:o}=e,{id:i,data:a}=t;var c;const{model:l,signatureHelpDismissedSpan:d}=n,u=(0,s.DY)(l,i),p=null===a||void 0===a||null===(c=a.applicableSpan)||void 0===c?void 0:c.start;if(!u||p&&p===d)return;void 0!==p&&(0,r.MR)((0,r.ym)({type:"notebook:cells:view:showSignatureHelp",eventVersion:1,notebook:n,currentUser:o}))},signatureHelpDismiss:(e,t)=>{let{notebook:n,currentUser:o}=e,{id:i,source:a}=t;const{model:c,signatureHelpData:l}=n;(0,s.DY)(c,i)&&l&&(0,r.MR)((0,r.ym)({type:"notebook:cells:view:dismissSignatureHelp",data:{source:a},eventVersion:1,notebook:n,currentUser:o}))},toggleHelpPaneSection:(e,t)=>{let{notebook:n,page:o,currentUser:s}=e,{section:i}=t;o.helpPaneSectionsOpen.has(i)?function(e,t,n){(0,r.MR)((0,r.ym)({type:"notebook:view:helpPaneSectionCollapsed",data:{section:e},eventVersion:1,notebook:t,currentUser:n}))}(i,n,s):function(e,t,n){(0,r.MR)((0,r.ym)({type:"notebook:view:helpPaneSectionExpanded",data:{section:e},eventVersion:1,notebook:t,currentUser:n}))}(i,n,s)},toggleCollectionsSidebar:e=>{let{notebook:t,currentUser:n,page:o}=e;(0,r.MR)((0,r.ym)({type:o.collectionsSidebarOpen?"notebook:view:collectionsSidebarDismissed":"notebook:view:collectionsSidebarOpened",data:{},eventVersion:1,notebook:t,currentUser:n}))},toggleDependencyLock:p.JS,upgradeDependency:p.Nz,togglePane:[_.Ez,(e,t)=>{let{page:n,notebook:o,currentUser:s}=e,{pane:i}=t;n.pane===i?b(i,null,o,s):(n.pane&&b(n.pane,i,o,s),function(e,t,n){switch(e){case"help":(0,r.MR)((0,r.ym)({type:"notebook:view:helpPaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}));break;case"files":(0,r.MR)((0,r.ym)({type:"notebook:view:filesPaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}));break;case"history":(0,r.MR)((0,r.ym)({type:"notebook:view:historyOpen",data:{},eventVersion:5,notebook:t,currentUser:n}));break;case"minimap":(0,r.MR)((0,r.ym)({type:"notebook:view:minimapPaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}));break;case"insights":(0,r.MR)((0,r.ym)({type:"notebook:view:insightsPaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}));break;case"find":(0,r.MR)((0,r.ym)({type:"notebook:view:findPaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}));break;case"dependencies":(0,r.MR)((0,r.ym)({type:"notebook:view:dependenciesPaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}));break;case"guide":(0,r.MR)((0,r.ym)({type:"notebook:view:guidePaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}));break;case"databases":(0,r.MR)((0,r.ym)({type:"notebook:view:databasesPaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}));break;default:m(e)}}(i,o,s))}],togglePin:(e,t)=>{let{notebook:n,currentUser:o}=e,{id:i}=t;const a=!(0,s.DY)(n.model,i).pinned;(0,r.MR)((0,r.ym)({type:a?"notebook:cells:manage:pin":"notebook:cells:manage:unpin",data:{cellIds:[i]},eventVersion:3,notebook:n,currentUser:o}))},toggleResolvedComments:(e,t)=>{let{notebook:n,currentUser:o}=e,{nodeId:s,trigger:i,source:a}=t;(0,r.MR)((0,r.ym)({type:"notebook:cells:comment:toggleResolved",data:{cellIds:[s],expanded:!n.expandedResolvedComments.has(s),trigger:i,source:a},eventVersion:2,notebook:n,currentUser:o}))},updateCommentingLock:[h.h,p.F5],updateSubscription:E.M,updateSubscriptionSucceeded:(e,t)=>{let{notebook:n,currentUser:o}=e,{status:s,trigger:i,source:a}=t;void 0!==i&&(0,r.MR)((0,r.ym)({type:"notebook:social:updateSubscription",data:{status:s,trigger:i,source:a},eventVersion:1,notebook:n,currentUser:o}))},welcomeMatNotebookClick:(e,t)=>{let{currentUser:n}=e,{clickedNotebookId:o}=t;(0,r.MR)((0,r.a$)({type:"marketing:view:welcomeMatNotebookClick",data:{clickedNotebookId:o},eventVersion:1,currentUser:n}))}}},94578:function(e,t,n){n.d(t,{c:function(){return i},q:function(){return a}});var o=n(59201),r=n(21857);var s=n(38559);function i(){let{initialCollection:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{pane:null,collectionsSidebarOpen:!!e,suggestionOpenBannerDismissed:!1,helpPaneSectionsOpen:o.y3,helpArticlesOpen:[],replaceInputExpanded:!1,findOptionsInputExpanded:!1,guide:null,expandedDatabases:new Set,expandedTables:new Set,databaseSchemas:new Map,tableSchemas:new Map}}const a={togglePane:o.lx,dismissPane:o.rE,toggleCollectionsSidebar:o.P4,openCollectionsSidebar:o._O,dismissSuggestionOpenBanner:()=>({suggestionOpenBannerDismissed:!0}),collectionsUpdated:o.Yd,toggleHelpPaneSection:o.GJ,closeHelpArticle:o.Gr,openHelpArticle:o.LZ,showNotebookDependencyDetails:(e,t)=>{let{specifier:n}=t;return{pane:"dependencies",dependenciesPaneSpecifier:n}},removeDependenciesPaneSpecifier:()=>({dependenciesPaneSpecifier:void 0}),toggleFindOptionsExpanded:s.lc,toggleReplaceInputExpanded:s.$k,toggleDatabasesPaneDatabase:(e,t)=>{let{expandedDatabases:n}=e,{db:o}=t;const s=(0,r.x2)(o);return n=new Set(n),n.has(s)?n.delete(s):n.add(s),{expandedDatabases:n}},toggleDatabasesPaneTable:(e,t)=>{let{expandedTables:n}=e,{db:o,table:s}=t;const i=(0,r.hS)(o,s);return n=new Set(n),n.has(i)?n.delete(i):n.add(i),{expandedTables:n}},updateDatabasesPaneDatabaseSchema:(e,t)=>{let{databaseSchemas:n}=e,{db:o,tables:s}=t;return n=new Map(n),n.set((0,r.x2)(o),s),{databaseSchemas:n}},updateDatabasesPaneTableSchema:(e,t)=>{let{tableSchemas:n}=e,{db:o,table:s,columns:i}=t;return n=new Map(n),n.set((0,r.hS)(o,s),i),{tableSchemas:n}},refreshDatabasesPaneSchema:(e,t)=>{let{expandedDatabases:n,databaseSchemas:o,tableSchemas:s}=e,{db:i}=t;n=new Set(n),o=new Map(o),s=new Map(s);const a=(0,r.x2)(i);n.add(a);const c=o.get(a);if(o.delete(a),c)for(const l of c)s.delete((0,r.hS)(i,l));return{tableSchemas:s,databaseSchemas:o,expandedDatabases:n}}}},4778:function(e){e.exports=JSON.parse('{"xF":"worker-7b657509.html","Bl":"worker-embed-preview-4cda3f23.html"}')}}]);