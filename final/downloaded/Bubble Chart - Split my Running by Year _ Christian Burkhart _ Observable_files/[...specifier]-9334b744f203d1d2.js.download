(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6869],{76364:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/collection/[at]/[...specifier]",function(){return n(22194)}])},57787:function(e,t,n){"use strict";n.d(t,{Fl:function(){return x},b3:function(){return y},fI:function(){return C},od:function(){return M}});var o=n(41799),r=n(85893),i=n(65988),a=n.n(i),s=n(54329),l=n(87769),c=n(46564),d=n(84749),u=n(84193),h=n(7483),m=n(12447),p=n(74873),g=n(70915),f=n(27193),v=n(67294),b=n(9383);const y=e=>{let{collection:t,format:n,index:o,parentCollection:i,reorder:a}=e;const s=i&&i.ordered,l=i&&void 0!==o&&i.ordered?o+1:void 0,d=(0,v.useRef)(null);(0,p.z)({index:o,ref:d,dataSelector:"collection-order",onDrop:a,disabled:!s});const u=s?(0,r.jsx)("button",{"aria-label":"Drag to reorder",className:"pv2 pr2 moon-gray hover-dark-gray bg-transparent bn tooltipped tooltipped-e",ref:d,style:{cursor:"grab",lineHeight:0},children:(0,r.jsx)(c.Z,{style:{width:14}})}):null;return(0,r.jsx)(w,{collection:t,format:n,url:(0,g.WG)(t),order:l,hamburger:u,showAccess:!0,showMenu:!0})},x=e=>{let{collection:t,format:n,index:o,parentCollection:i}=e;const a=i&&void 0!==o&&i.ordered?o+1:void 0;return(0,r.jsx)(w,{collection:t,format:n,url:(0,g.WG)(t),order:a,showMenu:!1})},w=e=>{let{collection:t,format:n="list",url:o,order:i,hamburger:a,showMenu:s,showAccess:l=!1}=e;const c=(0,m.GS)(m.ro),{title:d,description:h,listing_count:p,thumbnail:g}=t;return(0,r.jsxs)("div",{"data-cy":"collection-listing",className:"".concat("grid"===n?"pt2":"pv2 flex items-center"),children:[a,void 0!==i&&(0,r.jsxs)("div",{className:"mr2 f6 fw6",children:[i,"."]}),(0,r.jsx)(u.Z,{href:o,children:(0,r.jsx)("a",{className:"no-underline",children:(0,r.jsx)(k,{thumbnail:g,format:n,mobile:c})})}),(0,r.jsxs)("div",{className:"grid"===n?"pt2":"ml3 flex-auto",children:["grid"===n&&l&&(0,r.jsx)("div",{className:"mb1 f7 fw5 gray",children:(0,r.jsx)(M,{collection:t})}),(0,r.jsxs)("div",{className:"flex f6 fw6 justify-between lh-f6",children:[(0,r.jsx)("div",{children:(0,r.jsx)(u.Z,{href:o,children:(0,r.jsxs)("a",{className:"no-underline near-black hover-blue",children:[d,(0,r.jsxs)("span",{className:"fw5 gray",children:[" (",p,")"]})]})})}),"grid"===n&&s&&(0,r.jsx)(b.W,{collection:t,inList:!0})]}),(0,r.jsxs)("div",{className:"flex pr3 f7 fw5 mid-gray lh-title items-center truncate truncate-two-lines",title:h,children:["list"===n&&l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"gray",children:(0,r.jsx)(M,{collection:t})}),h?(0,r.jsx)("span",{className:"ph1 light-gray",children:"\u2022"}):null]}),h||null]})]}),"list"===n&&s&&(0,r.jsx)(b.W,{collection:t,inList:!0})]})},j={className:"mr1 moon-gray",height:13,width:13},M=e=>{let{collection:t,title:n,className:i,size:a}=e;return(0,r.jsxs)("span",{className:"inline-flex items-center".concat(i?" ".concat(i):""),title:n,children:["private"===t.type?(0,r.jsx)(d.Z,(0,o.Z)({},j,a)):(0,r.jsx)(l.Z,(0,o.Z)({},j,a)),(0,g.iM)(t)]})},k=e=>{let{thumbnail:t,format:n,mobile:o}=e;const i="grid"===n?10:8,s="calc(100% - ".concat(i,"px)");return(0,r.jsxs)("div",{style:"grid"===n?{paddingTop:"62.5%"}:{width:o?72:108,height:66},className:"jsx-84d72bb4b9015d25 relative collection-thumbnail",children:[(0,r.jsx)("div",{style:{top:i,left:i,width:s,height:s},className:"jsx-84d72bb4b9015d25 absolute bg-white ba b--silver br2"}),(0,r.jsx)("div",{style:{top:i/2,left:i/2,width:s,height:s},className:"jsx-84d72bb4b9015d25 absolute bg-white ba b--silver br2"}),(0,r.jsx)(h.p,{className:"absolute top-0 left-0 ba b--silver br2 overflow-hidden",style:{width:s,height:s},hash:t}),(0,r.jsx)(a(),{id:"84d72bb4b9015d25",children:".collection-thumbnail.jsx-84d72bb4b9015d25:hover div.jsx-84d72bb4b9015d25{-webkit-box-shadow:0 4px 12px rgba(0,0,0,.06);-moz-box-shadow:0 4px 12px rgba(0,0,0,.06);box-shadow:0 4px 12px rgba(0,0,0,.06);-webkit-transform:translateY(-1px);-moz-transform:translateY(-1px);-ms-transform:translateY(-1px);-o-transform:translateY(-1px);transform:translateY(-1px);border-color:var(--light-gray)}"})]})},C=e=>{let{collection:t}=e;return t.parent_collections.length<=0?null:(0,r.jsxs)(v.Fragment,{children:[(0,r.jsx)(s.Z,{className:"mr1 moon-gray",style:{flexShrink:0}}),(0,r.jsxs)("div",{className:"truncate",children:["Listed in"," ",(0,f.If)(t.parent_collections.map(((e,t)=>(0,r.jsx)(u.Z,{href:(0,g.WG)(e),children:(0,r.jsx)("a",{className:"no-underline dark-gray hover-blue",children:e.title})},t))))]})]})}},9383:function(e,t,n){"use strict";n.d(t,{W:function(){return h}});var o=n(85893),r=n(37497),i=n(33112),a=n(17764),s=n(14500),l=n(63231),c=n(21013),d=n(8433),u=n(42568);n(67294);const h=(0,n(56651).$j)(null,(e=>({dispatch:e})))((e=>{let{dispatch:t,collection:n,inList:h}=e;const m="parent_collections"in n?n.parent_collections.length:n.parent_collection_count;return(0,o.jsxs)(u.v2,{children:[h?(0,o.jsx)(r.hU,{"data-cy":"collection-actions",className:"moon-gray hover-near-black",icon:s.Z,colorless:!0,asMenuButton:!0}):(0,o.jsx)(r.aX,{"data-cy":"edit-collection",text:"Edit",icon:a.Z,colorless:!0,asMenuButton:!0,iconOnRight:!0}),(0,o.jsxs)(u.qy,{children:[(0,o.jsxs)(u.sN,{onSelect:()=>{t({type:"showModal",modal:"editCollection",modalProps:{collection:n}})},children:[(0,o.jsx)(l.Z,{className:"mr2"}),"Edit Collection"]}),(0,o.jsxs)(u.sN,{onSelect:()=>{t({type:"showModal",modal:"collections",modalProps:{collectionListing:n}})},children:[(0,o.jsx)(i.Z,{className:"mr2"}),m>0?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"nowrap",children:"In collections"}),(0,o.jsx)("span",{className:"ml2 f7 mid-gray bg-light-silver br2",style:{padding:"2px 4.5px"},children:m})]}):(0,o.jsx)("span",{className:"nowrap",children:"Add to collections"})]}),(0,o.jsxs)(u.sN,{onSelect:()=>{t({type:"showModal",modal:"setThumbnail",modalProps:{collection:n}})},children:[(0,o.jsx)(c.Z,{className:"mr2"})," Set thumbnail"]}),(0,o.jsxs)(u.sN,{onSelect:()=>{t({type:"showModal",modal:"deleteCollection",modalProps:{collection:n}})},className:"hover-dark-red hover-bg-washed-red",children:[(0,o.jsx)(d.Z,{className:"mr2"})," Delete"]})]})]})}))},26561:function(e,t,n){"use strict";n.d(t,{I:function(){return r}});var o=n(85893);const r="w-100 mw-max-width ph4-l ph3 center";t.Z=e=>{let{mobile:t=!1,children:n}=e;return(0,o.jsx)("div",{className:"".concat(r," ").concat(t?" ":" flex"),children:n})}},3896:function(e,t,n){"use strict";n.d(t,{m:function(){return s}});var o=n(85893),r=n(15295),i=n(67294),a=n(26561);const s=()=>{const e=(0,i.useRef)(null);return(0,o.jsx)("footer",{ref:e,style:{zIndex:1,background:"linear-gradient(to bottom, rgba(255,255,255,0.0), white 2em)"},children:(0,o.jsx)("div",{className:"mv3 ".concat(a.I),children:(0,o.jsx)(r.$,{})})})}},33112:function(e,t,n){"use strict";var o=n(41799),r=n(69396),i=n(85893);n(67294);t.Z=e=>(0,i.jsxs)("svg",(0,r.Z)((0,o.Z)({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),{children:[(0,i.jsx)("path",{d:"M3 3H7.5V1H3V3ZM6.5 2V7.5H8.5V2H6.5ZM7.5 6.5H2V8.5H7.5V6.5ZM3 7.5V3H1V7.5H3ZM6.5 7.5V12H8.5V7.5H6.5ZM6.5 12H3V14H6.5V12ZM3 12V7.5H1V12H3ZM7.5 8.5H12V6.5H7.5V8.5ZM14 6.5V3H12V6.5H14ZM12 1H7.5V3H12V1ZM14 3C14 1.89543 13.1046 1 12 1V3H14ZM12 8.5C13.1046 8.5 14 7.60457 14 6.5H12V8.5ZM6.5 12V14C7.60457 14 8.5 13.1046 8.5 12H6.5ZM3 12H1C1 13.1046 1.89543 14 3 14V12ZM3 1C1.89543 1 1 1.89543 1 3H3V1Z",fill:"currentColor"}),(0,i.jsx)("line",{x1:"12",y1:"9",x2:"12",y2:"15",stroke:"currentColor",strokeWidth:"2"}),(0,i.jsx)("path",{d:"M15 12H9",stroke:"currentColor",strokeWidth:"2"})]}))},77419:function(e,t,n){"use strict";n.d(t,{bd:function(){return h},p1:function(){return m},wd:function(){return p}});var o=n(85893),r=n(10198),i=n(27193),a=n(88725),s=n(72760),l=n(3142);const c=512,d=new Set(["Paragraph","ATXHeading2","ATXHeading3","ATXHeading4","ATXHeading5"]),u=new Set(["EmphasisMark","LinkMark","LinkLabel","URL","HeaderMark"]),h=e=>{let{notebook:t}=e;const{model:n,thumbnail:r,saveTime:d,publishTime:u}=t,h=(0,i.Ui)(n),m=function(e){let t="";for(const r of e){const{body:e,tag:i}=(0,s.Qc)(r);if(e){var n,o;const r="TemplateLiteral"===e.type&&"md"===(null===i||void 0===i?void 0:i.input)?e.quasis:"TaggedTemplateExpression"===e.type&&"md"===(null===(n=e.tag)||void 0===n?void 0:n.name)?null===(o=e.quasi)||void 0===o?void 0:o.quasis:null,a=null===r||void 0===r?void 0:r.map((e=>e.value.raw)).join(" ");for(const e of f(a))if(t+="".concat(v(e)," "),t.length>c)return t.slice(0,c).trim()}}return t.trim()||null}(n.nodes),p=t.authors.length?t.authors:[t.owner],g=(0,a.UW)(t);return(0,o.jsxs)(o.Fragment,{children:[(0,l.cg)(t)||(0,l.nv)(t)?(0,o.jsx)("meta",{name:"robots",content:"noindex"}):null,(0,o.jsx)("meta",{property:"og:type",content:"article"}),(0,o.jsx)("meta",{property:"og:url",content:"".concat("https://observablehq.com").concat(g)}),(0,o.jsx)("meta",{property:"og:site_name",content:"Observable"}),(0,o.jsx)("meta",{name:"twitter:site",content:"@observablehq"}),(0,o.jsx)("meta",{name:"title",content:h}),(0,o.jsx)("meta",{property:"og:title",content:h}),m&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("meta",{name:"description",content:m}),(0,o.jsx)("meta",{property:"og:description",content:m})]}),r&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("meta",{property:"og:image",content:(0,a.Nl)(r)}),(0,o.jsx)("meta",{name:"twitter:card",content:"summary_large_image"})]}),(0,o.jsx)("meta",{name:"author",content:p.map((e=>(0,i.KY)(e))).join(", ")}),p.map((e=>(0,o.jsx)("meta",{name:"article:author",content:"".concat("https://observablehq.com","/@").concat(e.login)},e.login))),u&&(0,o.jsx)("meta",{property:"article:published_time",content:u.toISOString()}),(0,o.jsx)("meta",{property:"article:modified_time",content:d.toISOString()})]})},m=e=>{let{collection:t}=e;const{description:n,thumbnail:r,owner:s,owner:{login:l},slug:c,update_time:d}=t,u=(0,i.Ui)(t);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("meta",{property:"og:type",content:"article"}),(0,o.jsx)("meta",{property:"og:url",content:"".concat("https://observablehq.com","/collection/@").concat(l,"/").concat(c)}),(0,o.jsx)("meta",{property:"og:site_name",content:"Observable"}),(0,o.jsx)("meta",{name:"twitter:site",content:"@observablehq"}),(0,o.jsx)("meta",{name:"title",content:u}),(0,o.jsx)("meta",{property:"og:title",content:u}),n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("meta",{name:"description",content:n}),(0,o.jsx)("meta",{property:"og:description",content:n})]}),r&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("meta",{property:"og:image",content:(0,a.Nl)(r)}),(0,o.jsx)("meta",{name:"twitter:card",content:"summary_large_image"})]}),(0,o.jsx)("meta",{name:"author",content:(0,i.KY)(s)}),(0,o.jsx)("meta",{name:"article:author",content:"".concat("https://observablehq.com","/@").concat(l)}),(0,o.jsx)("meta",{property:"article:modified_time",content:d.toISOString()})]})},p=e=>{let{user:t}=e;const{avatar_url:n,bio:r,login:a}=t,s=(0,i.KY)(t),l="Recent notebooks by ".concat(s);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("meta",{property:"og:type",content:"profile"}),(0,o.jsx)("meta",{property:"og:url",content:"".concat("https://observablehq.com","/@").concat(a)}),(0,o.jsx)("meta",{property:"og:site_name",content:"Observable"}),(0,o.jsx)("meta",{name:"twitter:site",content:"@observablehq"}),(0,o.jsx)("meta",{name:"title",content:l}),(0,o.jsx)("meta",{property:"og:title",content:l}),(0,o.jsx)("meta",{property:"description",content:r}),(0,o.jsx)("meta",{property:"og:description",content:r}),n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("meta",{property:"og:image",content:n}),(0,o.jsx)("meta",{name:"twitter:card",content:"summary"})]}),(0,o.jsx)("meta",{property:"profile:last_name",content:s}),(0,o.jsx)("meta",{property:"profile:username",content:a})]})};function g(e){const t=r.E2.startParse(e);let n;for(;!(n=t.advance()););return n}function*f(e){if(!e)return;const t=g(e).cursor();for(;t.next();)d.has(t.name)&&(yield e.slice(t.from,t.to))}function v(e){let t=e;const n=g(e).cursor();for(n.lastChild();n.prev();)u.has(n.name)&&(t=t.slice(0,n.from)+t.slice(n.to));return t.trim()}},65878:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var o=n(41799),r=n(99534),i=n(85893),a=n(51970),s=(n(67294),n(95542));function l(e){return t=>{var{error:n}=t,l=(0,r.Z)(t,["error"]);const c=(0,a.S)(l);return n?(0,i.jsx)(s.Z,{error:n,initialCurrentUser:c.initialCurrentUser,initialContext:null}):(0,i.jsx)(e,(0,o.Z)({},c))}}},22194:function(e,t,n){"use strict";n.r(t),n.d(t,{CollectionPage:function(){return X},__N_SSP:function(){return Y},default:function(){return q}});var o=n(41799),r=n(69396),i=n(85893),a=n(57787),s=n(9383),l=n(26561),c=n(3896),d=n(47417),u=n(40452),h=n(37497),m=n(99414),p=n(9234),g=n(62806),f=n(23105),v=n(19423),b=n(77419),y=n(39736),x=n(65878),w=n(12447),j=n(19671),M=n(27193),k=n(66421),C=n(9008),O=n.n(C),S=n(41664),I=n.n(S),N=n(67294),_=n(56651),P=n(68298),Z=n(77180),R=n(810),T=n(54937),D=n(602);var H=n(11163),U=n.n(H);function L(){U().replace(U().asPath)}const V={collectionsUpdated:(e,t)=>{let{collection:n}=e,{removedFrom:o}=t;o.some((e=>e.id===n.id))&&L()},updatedNotebook:(e,t,n)=>{let{collection:i,notebook:a}=e;if(!i.listings.results.find((e=>"notebook"===e.listing_type&&e.id===a.id))||a.trashed)return void L();const s=(0,r.Z)((0,o.Z)({},i.listings),{results:i.listings.results.map((e=>"notebook"===e.listing_type&&e.id===a.id?(0,o.Z)({},e,a):e))});n({type:"updatedCollection",collection:(0,r.Z)((0,o.Z)({},i),{listings:s})})},reorderCollection:async(e,t,n)=>{let{collection:i}=e,{document_listing_id:a,collection_listing_id:s,oldOrder:l,newOrder:c}=t;try{await(0,D.Fv)("/collection/".concat(i.id,"/reorder"),{document_listing_id:a,collection_listing_id:s,order:c});const e=[...i.listings.results],[t]=e.splice(l,1);e.splice(c,0,t),n({type:"editCollectionSucceeded",collection:(0,r.Z)((0,o.Z)({},i),{listings:(0,r.Z)((0,o.Z)({},i.listings),{results:e})})})}catch(d){n({type:"showErrorToast",key:"editCollection",message:"Oops, reordering collection failed. Try again?"})}}};function E(e){return e.collection}const F={editCollectionSucceeded:(e,t)=>{let{collection:n}=t;return n},updatedCollection:(e,t)=>{let{collection:n}=t;return n}},A=e=>({type:"collection",slices:{collection:{initialState:E(e),reducers:F},notebook:{initialState:{},reducers:(0,o.Z)({},T.x,Z.L)}},listeners:(0,o.Z)({},R.l,P.R,V)});var z=n(11758),Y=!0;const X=e=>{const t=(0,z.M)(A,e);return(0,i.jsx)(_.zt,{store:t,children:(0,i.jsx)(B,{})})};var q=(0,x.Z)(X);const B=(0,_.$j)((e=>{let{collection:t,currentUser:n,context:{defaultTeam:o}}=e;return{collection:t,currentUser:n,defaultTeam:o}}),(e=>({dispatch:e})))((e=>{let{collection:t,dispatch:n,currentUser:a,defaultTeam:s}=e;const h=(0,w.GS)(w.ro),m=(0,N.useCallback)(((e,i,s)=>{let l;if(l=null===s?i:null===i?s:s===e||i===e?e:i<e?i:s,null!==l&&l!==e){const i=t.listings.results[e];n((0,r.Z)((0,o.Z)({type:"reorderCollection"},"notebook"===i.listing_type?{document_listing_id:i.id}:{collection_listing_id:i.id}),{oldOrder:e,newOrder:l})),"notebook"===i.listing_type?(0,j.MR)((0,j.y6)({type:"collection:manage:reorderNotebookListing",data:{},collection:t,currentUser:a,eventVersion:1})):(0,j.MR)((0,j.y6)({type:"collection:manage:reorderCollectionListing",data:{},collection:t,currentUser:a,eventVersion:1}))}}),[t,n,a]),p=a&&(t.owner.login===a.login||a.teams.some((e=>t.owner.login===e.login)));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(O(),{children:[(0,i.jsx)("link",{rel:"alternate",type:"application/rss+xml",title:"".concat((0,M.Ui)(t)," / ").concat((0,M.KY)(t.owner)," / Observable"),href:"".concat("https://api.observablehq.com","/collection/@").concat(t.owner.login,"/").concat(t.slug,".rss")}),(0,i.jsxs)("title",{children:[(0,M.Ui)(t)," / ",(0,M.KY)(t.owner)," / Observable"]}),(0,i.jsx)(b.p1,{collection:t})]}),(0,i.jsxs)("div",{className:"flex flex-column min-vh-100",children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)("main",{className:"relative",style:{flex:1,zIndex:0},children:(0,i.jsxs)(l.Z,{mobile:h,children:[p?(0,i.jsx)(d.X,{tab:"collections"}):(0,i.jsx)(d.mx,{user:t.owner,userLogin:t.owner.login,tab:"collections",collectionSlug:t.slug}),(0,i.jsx)("div",{className:"mt4 mb4 flex-auto",children:(0,i.jsx)(W,{collection:t,currentUser:a,dispatch:n,reorder:m,defaultTeam:s})})]})}),(0,i.jsx)(u.j,{}),(0,i.jsx)(y.F1,{}),(0,i.jsx)(c.m,{})]})]})})),W=e=>{let{collection:t,currentUser:n,dispatch:o,reorder:r,defaultTeam:l}=e;const{owner:c}=t,d=t.listings.per_page*(t.listings.page-1);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex justify-between items-start",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("h1",{style:f.r2,className:"ma0 fw7 near-black",children:[(0,i.jsxs)("div",{className:"flex mb2 f6 fw4 mid-gray items-center",children:[(0,i.jsx)(a.od,{title:"This collection is ".concat("private"===t.type?"team"===c.type?"only visible to team members":"only visible to you":"visible to everyone","."),collection:t,size:{height:16,width:16},className:"mr3"}),(0,i.jsx)(a.fI,{collection:t})]}),t.title]}),(0,i.jsx)("div",{className:"measure-wide mt2 f6 mid-gray lh-copy",children:t.description})]}),(0,k.D7)(n,t)&&(0,i.jsxs)("div",{className:"flex flex-no-shrink",children:[(0,i.jsx)(s.W,{collection:t}),(0,i.jsx)(I(),{href:"".concat(l?"/team/@".concat(l.login,"/new"):"/new","?collection=").concat(t.id),children:(0,i.jsx)("a",{className:"no-underline",onClick:e=>{e.metaKey||e.ctrlKey||(e.preventDefault(),o({type:"showModal",modal:"newNotebook",trigger:"click",source:"newNotebookButton",modalProps:{presetTeam:l,presetCollectionId:t.id}}))},children:(0,i.jsx)(h.aX,{"data-cy":"add-notebook",text:"New notebook",className:"ml2",colorless:!0,icon:m.Z})})})]})]}),(0,i.jsx)(p.a,{emptyMessage:"This collection doesn\u2019t contain any listings yet.",response:t.listings,ordered:t.ordered,items:"listings",children:(e,s,l)=>(0,i.jsxs)("div",{"data-collection-order":l,className:"relative",children:[(0,i.jsx)("div",{className:"bg-light-blue drag-marker-before",style:{top:-2,right:0,left:0}}),"notebook"===e.listing_type?(0,i.jsx)(f.pg,{format:s,notebook:(0,g.H)(e),currentUser:n,dispatch:o,reorder:r,collection:t,index:l+d}):(0,k.D7)(n,e)?(0,i.jsx)(a.b3,{collection:e,format:s,reorder:r,parentCollection:t,parentCount:e.parent_collection_count,index:l+d}):(0,i.jsx)(a.Fl,{collection:e,format:s,parentCollection:t,index:l+d}),(0,i.jsx)("div",{className:"bg-light-blue drag-marker-after",style:{bottom:-1,right:0,left:0}})]})})]})}},56651:function(e,t,n){"use strict";n.d(t,{$j:function(){return i},zt:function(){return o.zt}});var o=n(14416),r=n(54924);const i=(0,r.S3)();(0,r.gR)()},27011:function(e,t,n){e.exports=function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=n(e),r=n(t);function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function l(e,t){var n,o=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)),o}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t){if(null==e)return{};var n,o=function(e,t){if(null==e)return{};for(var n,o={},r=Object.keys(e),i=0;i<r.length;i++)n=r[i],0<=t.indexOf(n)||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(e),i=0;i<r.length;i++)n=r[i],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n]);return o}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var e,o,r=d(t);return!(o=n?(e=d(this).constructor,Reflect.construct(r,arguments,e)):r.apply(this,arguments))||"object"!=typeof o&&"function"!=typeof o?m(this):o}}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==s.return||s.return()}finally{if(r)throw i}}return n}}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function b(e,t){return new Promise((function(n,o){var r,i=new Image;i.onload=function(){return n(i)},i.onerror=o,0==(null!==(r=e)&&!!r.match(/^\s*data:([a-z]+\/[a-z]+(;[a-z-]+=[a-z-]+)?)?(;base64)?,[a-z0-9!$&',()*+;=\-._~:@/?%\s]*\s*$/i))&&t&&(i.crossOrigin=t),i.src=e}))}var y,x=!("undefined"==typeof window||"undefined"==typeof navigator||!("ontouchstart"in window||0<navigator.msMaxTouchPoints)),w="undefined"!=typeof File,j={touch:{react:{down:"onTouchStart",mouseDown:"onMouseDown",drag:"onTouchMove",move:"onTouchMove",mouseMove:"onMouseMove",up:"onTouchEnd",mouseUp:"onMouseUp"},native:{down:"touchstart",mouseDown:"mousedown",drag:"touchmove",move:"touchmove",mouseMove:"mousemove",up:"touchend",mouseUp:"mouseup"}},desktop:{react:{down:"onMouseDown",drag:"onDragOver",move:"onMouseMove",up:"onMouseUp"},native:{down:"mousedown",drag:"dragStart",move:"mousemove",up:"mouseup"}}},M=x?j.touch:j.desktop,k="undefined"!=typeof window&&window.devicePixelRatio?window.devicePixelRatio:1,C={x:.5,y:.5},O=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(l,r.default.Component);var e,t,n,o=p(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),a(m(t=o.call(this,e)),"state",{drag:!1,my:null,mx:null,image:C}),a(m(t),"handleImageReady",(function(e){var n=t.getInitialSize(e.width,e.height);n.resource=e,n.x=.5,n.y=.5,n.backgroundColor=t.props.backgroundColor,t.setState({drag:!1,image:n},t.props.onImageReady),t.props.onLoadSuccess(n)})),a(m(t),"clearImage",(function(){t.canvas.getContext("2d").clearRect(0,0,t.canvas.width,t.canvas.height),t.setState({image:C})})),a(m(t),"handleMouseDown",(function(e){(e=e||window.event).preventDefault(),t.setState({drag:!0,mx:null,my:null})})),a(m(t),"handleMouseUp",(function(){t.state.drag&&(t.setState({drag:!1}),t.props.onMouseUp())})),a(m(t),"handleMouseMove",(function(e){var n,o,r,i,a,s,l,d,u,h,m,p,g,f,v,b;e=e||window.event,!1!==t.state.drag&&(e.preventDefault(),r={mx:n=e.targetTouches?e.targetTouches[0].pageX:e.clientX,my:o=e.targetTouches?e.targetTouches[0].pageY:e.clientY},b=t.props.rotate,b=(b%=360)<0?b+360:b,t.state.mx&&t.state.my&&(i=t.state.mx-n,a=t.state.my-o,s=t.state.image.width*t.props.scale,l=t.state.image.height*t.props.scale,u=(d=t.getCroppingRect()).x,h=d.y,u*=s,h*=l,m=function(e){return e*(Math.PI/180)},p=Math.cos(m(b)),f=h+-i*(g=Math.sin(m(b)))+a*p,v={x:(u+i*p+a*g)/s+1/t.props.scale*t.getXScale()/2,y:f/l+1/t.props.scale*t.getYScale()/2},t.props.onPositionChange(v),r.image=c(c({},t.state.image),v)),t.setState(r),t.props.onMouseMove(e))})),a(m(t),"setCanvas",(function(e){t.canvas=e})),t.canvas=null,t}return e=l,(t=[{key:"componentDidMount",value:function(){this.props.disableHiDPIScaling&&(k=1);var e,t,n=this.canvas.getContext("2d");this.props.image&&this.loadImage(this.props.image),this.paint(n),document&&(e=!!function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){e=!1}return e}()&&{passive:!1},t=M.native,document.addEventListener(t.move,this.handleMouseMove,e),document.addEventListener(t.up,this.handleMouseUp,e),x&&(document.addEventListener(t.mouseMove,this.handleMouseMove,e),document.addEventListener(t.mouseUp,this.handleMouseUp,e)))}},{key:"componentDidUpdate",value:function(e,t){this.props.image&&this.props.image!==e.image||this.props.width!==e.width||this.props.height!==e.height||this.props.backgroundColor!==e.backgroundColor?this.loadImage(this.props.image):this.props.image||t.image===C||this.clearImage();var n=this.canvas.getContext("2d");n.clearRect(0,0,this.canvas.width,this.canvas.height),this.paint(n),this.paintImage(n,this.state.image,this.props.border),e.image===this.props.image&&e.width===this.props.width&&e.height===this.props.height&&e.position===this.props.position&&e.scale===this.props.scale&&e.rotate===this.props.rotate&&t.my===this.state.my&&t.mx===this.state.mx&&t.image.x===this.state.image.x&&t.image.y===this.state.image.y&&t.backgroundColor===this.state.backgroundColor||this.props.onImageChange()}},{key:"componentWillUnmount",value:function(){var e;document&&(e=M.native,document.removeEventListener(e.move,this.handleMouseMove,!1),document.removeEventListener(e.up,this.handleMouseUp,!1),x&&(document.removeEventListener(e.mouseMove,this.handleMouseMove,!1),document.removeEventListener(e.mouseUp,this.handleMouseUp,!1)))}},{key:"isVertical",value:function(){return!this.props.disableCanvasRotation&&this.props.rotate%180!=0}},{key:"getBorders",value:function(e){var t=0<arguments.length&&void 0!==e?e:this.props.border;return Array.isArray(t)?t:[t,t]}},{key:"getDimensions",value:function(){var e=this.props,t=e.width,n=e.height,o=e.rotate,r=e.border,i={},a=g(this.getBorders(r),2),s=a[0],l=a[1],c=t,d=n;return this.isVertical()?(i.width=d,i.height=c):(i.width=c,i.height=d),i.width+=2*s,i.height+=2*l,{canvas:i,rotate:o,width:t,height:n,border:r}}},{key:"getImage",value:function(){var e=this.getCroppingRect(),t=this.state.image;e.x*=t.resource.width,e.y*=t.resource.height,e.width*=t.resource.width,e.height*=t.resource.height;var n=document.createElement("canvas");this.isVertical()?(n.width=e.height,n.height=e.width):(n.width=e.width,n.height=e.height);var o=n.getContext("2d");return o.translate(n.width/2,n.height/2),o.rotate(this.props.rotate*Math.PI/180),o.translate(-n.width/2,-n.height/2),this.isVertical()&&o.translate((n.width-n.height)/2,(n.height-n.width)/2),t.backgroundColor&&(o.fillStyle=t.backgroundColor,o.fillRect(-e.x,-e.y,t.resource.width,t.resource.height)),o.drawImage(t.resource,-e.x,-e.y),n}},{key:"getImageScaledToCanvas",value:function(){var e=this.getDimensions(),t=e.width,n=e.height,o=document.createElement("canvas");return this.isVertical()?(o.width=n,o.height=t):(o.width=t,o.height=n),this.paintImage(o.getContext("2d"),this.state.image,0,1),o}},{key:"getXScale",value:function(){var e=this.props.width/this.props.height,t=this.state.image.width/this.state.image.height;return Math.min(1,e/t)}},{key:"getYScale",value:function(){var e=this.props.height/this.props.width,t=this.state.image.height/this.state.image.width;return Math.min(1,e/t)}},{key:"getCroppingRect",value:function(){var e=this.props.position||{x:this.state.image.x,y:this.state.image.y},t=1/this.props.scale*this.getXScale(),n=1/this.props.scale*this.getYScale(),o={x:e.x-t/2,y:e.y-n/2,width:t,height:n},r=0,i=1-o.width,a=0,s=1-o.height;return(this.props.disableBoundaryChecks||1<t||1<n)&&(r=-o.width,a=-o.height,s=i=1),c(c({},o),{},{x:Math.max(r,Math.min(o.x,i)),y:Math.max(a,Math.min(o.y,s))})}},{key:"loadImage",value:function(e){var t;w&&e instanceof File?this.loadingImage=(t=e,new Promise((function(e,n){var o=new FileReader;o.onload=function(t){try{var o=b(t.target.result);e(o)}catch(t){n(t)}},o.readAsDataURL(t)})).then(this.handleImageReady).catch(this.props.onLoadFailure)):"string"==typeof e&&(this.loadingImage=b(e,this.props.crossOrigin).then(this.handleImageReady).catch(this.props.onLoadFailure))}},{key:"getInitialSize",value:function(e,t){var n,o,r=this.getDimensions();return t/e<r.height/r.width?o=e*((n=this.getDimensions().height)/t):n=t*((o=this.getDimensions().width)/e),{height:n,width:o}}},{key:"paintImage",value:function(e,t,n,o){var r,i=3<arguments.length&&void 0!==o?o:k;t.resource&&(r=this.calculatePosition(t,n),e.save(),e.translate(e.canvas.width/2,e.canvas.height/2),e.rotate(this.props.rotate*Math.PI/180),e.translate(-e.canvas.width/2,-e.canvas.height/2),this.isVertical()&&e.translate((e.canvas.width-e.canvas.height)/2,(e.canvas.height-e.canvas.width)/2),e.scale(i,i),e.globalCompositeOperation="destination-over",e.drawImage(t.resource,r.x,r.y,r.width,r.height),t.backgroundColor&&(e.fillStyle=t.backgroundColor,e.fillRect(r.x,r.y,r.width,r.height)),e.restore())}},{key:"calculatePosition",value:function(e,t){e=e||this.state.image;var n=g(this.getBorders(t),2),o=n[0],r=n[1],i=this.getCroppingRect(),a=e.width*this.props.scale,s=e.height*this.props.scale,l=-i.x*a,c=-i.y*s;return this.isVertical()?(l+=r,c+=o):(l+=o,c+=r),{x:l,y:c,height:s,width:a}}},{key:"paint",value:function(e){e.save(),e.scale(k,k),e.translate(0,0),e.fillStyle="rgba("+this.props.color.slice(0,4).join(",")+")";var t,n,o,r,i,a,s,l,c=this.props.borderRadius,d=this.getDimensions(),u=g(this.getBorders(d.border),2),h=u[0],m=u[1],p=d.canvas.height,f=d.canvas.width;c=Math.max(c,0),c=Math.min(c,f/2-h,p/2-m),e.beginPath(),t=e,r=f-2*(n=h),i=p-2*(o=m),0===(a=c)?t.rect(n,o,r,i):(s=r-a,l=i-a,t.translate(n,o),t.arc(a,a,a,Math.PI,1.5*Math.PI),t.lineTo(s,0),t.arc(s,a,a,1.5*Math.PI,2*Math.PI),t.lineTo(r,l),t.arc(s,l,a,2*Math.PI,.5*Math.PI),t.lineTo(a,i),t.arc(a,l,a,.5*Math.PI,Math.PI),t.translate(-n,-o)),e.rect(f,0,-f,p),e.fill("evenodd"),e.restore()}},{key:"render",value:function(){var e=this.props,t=(e.scale,e.rotate,e.image,e.border,e.borderRadius,e.width,e.height,e.position,e.color,e.backgroundColor,e.style),n=(e.crossOrigin,e.onLoadFailure,e.onLoadSuccess,e.onImageReady,e.onImageChange,e.onMouseUp,e.onMouseMove,e.onPositionChange,e.disableBoundaryChecks,e.disableHiDPIScaling,e.disableCanvasRotation,h(e,["scale","rotate","image","border","borderRadius","width","height","position","color","backgroundColor","style","crossOrigin","onLoadFailure","onLoadSuccess","onImageReady","onImageChange","onMouseUp","onMouseMove","onPositionChange","disableBoundaryChecks","disableHiDPIScaling","disableCanvasRotation"])),o=this.getDimensions(),i={width:o.canvas.width,height:o.canvas.height,cursor:this.state.drag?"grabbing":"grab",touchAction:"none"},a={width:o.canvas.width*k,height:o.canvas.height*k,style:c(c({},i),t)};return a[M.react.down]=this.handleMouseDown,x&&(a[M.react.mouseDown]=this.handleMouseDown),r.default.createElement("canvas",s({ref:this.setCanvas},a,n))}}])&&i(e.prototype,t),n&&i(e,n),l}();return a(O,"propTypes",{scale:o.default.number,rotate:o.default.number,image:o.default.oneOfType([o.default.string].concat(function(e){if(Array.isArray(e))return v(e)}(y=w?[o.default.instanceOf(File)]:[])||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(y)||f(y)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),border:o.default.oneOfType([o.default.number,o.default.arrayOf(o.default.number)]),borderRadius:o.default.number,width:o.default.number,height:o.default.number,position:o.default.shape({x:o.default.number,y:o.default.number}),color:o.default.arrayOf(o.default.number),backgroundColor:o.default.string,crossOrigin:o.default.oneOf(["","anonymous","use-credentials"]),onLoadFailure:o.default.func,onLoadSuccess:o.default.func,onImageReady:o.default.func,onImageChange:o.default.func,onMouseUp:o.default.func,onMouseMove:o.default.func,onPositionChange:o.default.func,disableBoundaryChecks:o.default.bool,disableHiDPIScaling:o.default.bool,disableCanvasRotation:o.default.bool}),a(O,"defaultProps",{scale:1,rotate:0,border:25,borderRadius:0,width:200,height:200,color:[0,0,0,.5],onLoadFailure:function(){},onLoadSuccess:function(){},onImageReady:function(){},onImageChange:function(){},onMouseUp:function(){},onMouseMove:function(){},onPositionChange:function(){},disableBoundaryChecks:!1,disableHiDPIScaling:!1,disableCanvasRotation:!0}),O}(n(45697),n(67294))}},function(e){e.O(0,[5880,9874,2656,793,8764,3639,5352,2338,8367,2321,5542,7417,5299,3504,1861,1067,8024,9774,2888,179],(function(){return t=76364,e(e.s=t);var t}));var t=e.O();_N_E=t}]);